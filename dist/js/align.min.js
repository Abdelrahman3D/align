var e,t;e=this,t=function(){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),i=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},t=function e(t,n,i){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,n);if(void 0===a){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,n,i)}if("value"in a)return a.value;var r=a.get;return void 0!==r?r.call(i):void 0},n=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},o=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)};function l(e){return"string"==typeof e?document.querySelector(e):e}function e(){if("undefined"!=typeof window&&"undefined"!=typeof document){var e=navigator.appVersion;return-1!==e.indexOf("Win")?"Win":-1!==e.indexOf("Mac")?"Mac":-1!==e.indexOf("X11")?"UNIX":-1!==e.indexOf("Linux")?"Linux":"Other"}}function u(e,t){for(;e!==document&&null!==e;){if(e===t)return!0;e=e.parentNode}return!1}function d(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"middle-left";if("function"==typeof e.getBoundingClientRect){var i,a,s,r=t.parentNode,o=n.split("-"),l=e.getBoundingClientRect(),c=t.getBoundingClientRect(),u=r.getBoundingClientRect(),d=r.scrollTop,h={x:0,y:0},p=u.width-c.width;return o.forEach(function(e){switch(e){case"center":h.x=l.left-u.left+l.width/2-c.width/2;break;case"left":h.x=l.left-u.left;break;case"right":h.x=l.left-u.left-l.width;break;case"middle":h.y=l.top-u.top+d+l.height/2-c.height/2;break;case"top":h.y=l.top-u.top+d-c.height;break;case"bottom":h.y=l.bottom-u.top+d}}),h.x=(i=h.x,a=0,s=p,Math.round(Math.max(Math.min(Number(i),s),a))),t.style.transform="translate("+h.x+"px, "+h.y+"px)",h}}function p(e){return document.createRange().createContextualFragment(e).firstElementChild}function h(e,t,n){var i=e[t];return e[t]=e[n],e[n]=i,e}function m(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;"function"==typeof e&&e(t)}var g=function(){function t(e){c(this,t),this.el=document.createElement("input"),this.el.type="range",this.settings=Object.assign({},t.defaults,e),this._init()}return a(t,[{key:"_init",value:function(){this.min=this.el.min=Number(this.settings.min),this.max=this.el.max=Number(this.settings.max),this.step=this.el.step=Number(this.settings.step),this.value=this.el.value=Number(this.settings.value);var e=this.step.toString().split(".")[1];this.decimalsCount=e?e.length:0,this._initElements(),this._initEvents()}},{key:"_initElements",value:function(){var e;(this.wrapper=document.createElement("div"),this.track=document.createElement("div"),this.wrapper.classList.add("slider"),this.settings.classes)&&(e=this.wrapper.classList).add.apply(e,o(this.settings.classes));this.track.classList.add("slider-track"),this.el.classList.add("slider-input"),this.fill=document.createElement("div"),this.fill.classList.add("slider-fill"),this.track.appendChild(this.fill),this.handle=p('<div class="slider-handle"></div>'),this.handle.addEventListener("mousedown",this.select.bind(this),!1),this.handle.addEventListener("touchstart",this.select.bind(this),!1),this.track.appendChild(this.handle),this.wrapper.appendChild(this.el),this.wrapper.appendChild(this.track)}},{key:"_initEvents",value:function(){var e=this;window.addEventListener("resize",function(){e.updateWidth(),e.update(void 0,!0)}),this.track.addEventListener("mousedown",this.select.bind(this),!1),this.track.addEventListener("touchstart",this.select.bind(this),!1)}},{key:"select",value:function(e){if(e.preventDefault(),e.stopPropagation(),1===e.buttons){this.updateWidth(),this.track.classList.add("is-dragging"),this.ticking=!1;var t=this.getStepValue(e);this.update(t),this.tempDrag=this.dragging.bind(this),this.tempRelease=this.release.bind(this),document.addEventListener("mousemove",this.tempDrag),document.addEventListener("touchmove",this.tempDrag),document.addEventListener("touchend",this.tempRelease),document.addEventListener("mouseup",this.tempRelease)}}},{key:"dragging",value:function(e){var t=this;e.preventDefault();var n=this.getStepValue(e);this.ticking||(window.requestAnimationFrame(function(){t.update(n),t.ticking=!1}),this.ticking=!0)}},{key:"release",value:function(){this.track.classList.remove("is-dragging"),document.removeEventListener("mousemove",this.tempDrag),document.removeEventListener("touchmove",this.tempDrag),document.removeEventListener("mouseup",this.tempRelease),document.removeEventListener("touchend",this.tempRelease)}},{key:"getStepValue",value:function(e){var t=(e.type.includes("mouse")?e.clientX:e.type.includes("touch")?e.touches[0].clientX:e)-this.currentX,n=parseInt(t/this.stepWidth+.5,10)*this.step+this.min;return this.decimalsCount?Number(n.toFixed(this.decimalsCount)):n}},{key:"updateWidth",value:function(){var e=this.track.getBoundingClientRect();this.currentX=e.left,this.width=e.width,this.stepWidth=this.width/(this.max-this.min)*this.step}},{key:"getPositionPercentage",value:function(e){return(e-this.min)/(this.max-this.min)}},{key:"normalizeValue",value:function(e){return isNaN(Number(e))?this.value:Math.min(Math.max(Number(e),this.min),this.max)}},{key:"update",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=this.normalizeValue(e),i=this.getPositionPercentage(n);this.fill.style.transform="translate("+i*this.width+"px, 0) scale("+(1-i)+", 1)",this.handle.style.transform="translate("+i*this.width+"px, 0)",this.value=n,this.el.value=this.value,t||(this.el.dispatchEvent(new Event("change")),this.el.dispatchEvent(new Event("input")))}}]),t}();g.defaults={created:{},updated:{},gradient:null,classes:null,colorCode:!1,editable:!1,reverse:!1,label:!0,min:0,max:10,step:1,value:1,trackSlide:!0};var v=function(){function t(){c(this,t),this.subscribers=[]}return a(t,null,[{key:"watcher",value:function(e){t.target=e,t.target(),t.target=null}}]),a(t,[{key:"depend",value:function(){t.target&&!this.subscribers.includes(t.target)&&this.subscribers.push(t.target)}},{key:"notify",value:function(t){this.subscribers.forEach(function(e){return e(t)})}}]),t}();v.target=null;var f="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)},b=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},y=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),k=function e(t,n,i){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,n);if(void 0===a){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,n,i)}if("value"in a)return a.value;var r=a.get;return void 0!==r?r.call(i):void 0},L=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},H=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t};function C(e){return"object"===(void 0===e?"undefined":f(e))&&e.model?e.model:("#"!==e.slice(0,1)||4!==e.length&&7!==e.length)&&("#"!==e.slice(0,1)||6!==e.length&&9!==e.length)?"RGBA"===e.slice(0,4).toUpperCase()?"rgb":"RGB"===e.slice(0,3).toUpperCase()?"rgb":"HSLA"===e.slice(0,4).toUpperCase()?"hsl":"HSL"===e.slice(0,3).toUpperCase()&&"hsl":"hex"}function V(e){return isNaN(parseInt(e,16))?0:parseInt(e,16)}function w(t,n){return function(e){return t<=e&&e<=n}}var E=function(){function e(t){var n=this;b(this,e),this.invalid=!this.validate(t),this.invalid||Object.keys(t).forEach(function(e){n[e]=t[e]}),this.init()}return y(e,[{key:"init",value:function(){}},{key:"validate",value:function(e){return!!e&&"object"===(void 0===e?"undefined":f(e))}}]),e}(),M=function(e){function n(){return b(this,n),H(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return L(n,E),y(n,[{key:"validate",value:function(e){if(!k(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"validate",this).call(this,e))return!1;var t=w(0,255);return t(e.red)&&t(e.green)&&t(e.blue)}},{key:"init",value:function(){this.model="rgb",this.alpha=void 0===this.alpha?1:this.alpha}},{key:"toString",value:function(){return this.invalid?"Invalid Color":w(0,.999)(this.alpha)?"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")":"rgb("+this.red+","+this.green+","+this.blue+")"}}]),n}(),A=function(e){function n(){return b(this,n),H(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return L(n,E),y(n,[{key:"validate",value:function(e){if(!k(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"validate",this).call(this,e))return!1;var t=w(0,100);return w(0,360)(e.hue)&&t(e.lum)&&t(e.sat)}},{key:"init",value:function(){this.model="hsl",this.alpha=this.alpha||1}},{key:"toString",value:function(){return this.invalid?"Invalid Color":w(0,.999)(this.alpha)?"hsla("+this.hue+","+this.sat+"%,"+this.lum+"%,"+this.alpha+")":"hsl("+this.hue+","+this.sat+"%,"+this.lum+"%)"}}]),n}(),x=function(e){function t(){return b(this,t),H(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return L(t,E),y(t,[{key:"validate",value:function(e){return!!k(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"validate",this).call(this,e)&&/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test("#"+e.red+e.green+e.blue)}},{key:"init",value:function(){this.model="hex",this.alpha=this.alpha||"ff"}},{key:"toString",value:function(){return this.invalid?"Invalid Color":w(0,.999)(V(this.alpha)/255)?"#"+this.red+this.green+this.blue+this.alpha:"#"+this.red+this.green+this.blue}}]),t}();function _(e){if("object"===(void 0===e?"undefined":f(e)))return e;var t=e.match(/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,*\s*(\d*(?:\.\d+)*)*\)/i);return!t||t.length<4?new M:new M({red:Number(t[1]),green:Number(t[2]),blue:Number(t[3]),alpha:Number(t[4])})}function S(e){if("object"===(void 0===e?"undefined":f(e)))return e;var t,n,i=(n=/^#([a-f\d])([a-f\d])([a-f\d])([a-f\d])*$/i,5!==(t=e).length&&4!==t.length||!n.test(t)||(t=t.replace(n,function(e,t,n,i,a){return"#"+t+t+n+n+i+i+(a?""+a+a:"")})),t),a=i.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})*/i);return!a||a.length<4?new x:new x({hex:i,red:a[1],green:a[2],blue:a[3],alpha:a[4]})}function j(e){if("object"===(void 0===e?"undefined":f(e)))return e;var t=e.match(/^hsla?\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*,*\s*(\d*(?:\.\d+)*)*\)/i);return!t||t.length<4?new A:new A({hue:Number(t[1]),sat:Number(t[2]),lum:Number(t[3]),alpha:Number(t[4])})}function O(e){return e=Math.floor(e),isNaN(e)?"00":("0"+e.toString(16)).slice(-2)}function $(e){if(!e)return new x;var t=[O((e=_(e)).red),O(e.green),O(e.blue),e.alpha?O(255*e.alpha):null];return new x({red:t[0],green:t[1],blue:t[2],alpha:t[3]||"ff"})}function T(e){if(!e)return new A;var t=[(e=_(e)).red/255,e.green/255,e.blue/255,e.alpha],n=t[0],i=t[1],a=t[2],s=t[3],r=0,o=0,l=0,c=Math.min(n,i,a),u=Math.max(n,i,a);return l=(c+u)/2,c!==u&&(o=.5<l?(u-c)/(2-u-c):(u-c)/(u+c)),u<=n&&c!==u&&(r=(i-a)/(u-c)*60),u<=i&&c!==u&&(r=60*(2+(a-n)/(u-c))),u<=a&&c!==u&&(r=60*(4+(n-i)/(u-c))),r=r<0?Math.floor(r+360):Math.floor(r),o=Math.floor(100*o),l=Math.floor(100*l),new A({hue:r,sat:o,lum:l,alpha:s})}function I(e){if(!e)return new M;var t=S(e),n=t.red,i=t.green,a=t.blue,s=t.alpha;return new M({red:V(n),green:V(i),blue:V(a),alpha:void 0===s?1:Number((V(s)/255).toFixed(2))})}function z(e){return Math.min(Math.max(parseInt(e),0),255)}function P(e){if(!e)return new M;var t=[(e=j(e)).hue/360,e.sat/100,e.lum/100,e.alpha],n=t[0],i=t[1],a=t[2],s=t[3],r=0,o=0,l=0;if(0===i&&(r=o=l=z(255*a)),0!==i){var c=50<=a?a+i-a*i:a*(1+i),u=2*a-c,d=function(e){return e<0&&(e+=1),1<e&&(e-=1),e<1/6?u+6*(c-u)*e:e<.5?c:e<2/3?u+(c-u)*(2/3-e)*6:u};r=z(255*d(n+1/3)),o=z(255*d(n)),l=z(255*d(n-1/3))}return new M({red:r,green:o,blue:l,alpha:s})}function N(e){var t,n=C(e);return"hex"===n?(t=e)?T(I(t)):new A:"rgb"===n?T(e):"hsl"===n&&"string"==typeof e?j(e):"hsl"===n&&"object"===(void 0===e?"undefined":f(e))?e:new A}function F(e){var t,n=C(e);return"rgb"===n?$(e):"hsl"===n?(t=e)?$(P(t)):new x:"hex"===n&&"string"==typeof e?S(e):"hex"===n&&"object"===(void 0===e?"undefined":f(e))?e:new x}var q=function(){function n(e,t){c(this,n),this.el=l(e),this.settings=Object.assign({},n.defaults,t),this.init()}return a(n,[{key:"init",value:function(){this.events=[new Event("input"),new Event("change")],this.colors={current:{},model:this.settings.model,alpha:1,rgb:{},hsl:{},hex:{}},this._initElements(),this._initInputs(),this._initWatchers(),this._initEvents(),this.selectColor(this.settings.defaultColor,!0)}},{key:"_initWatchers",value:function(){var t=this;Object.keys(this.colors).forEach(function(e){var n=t.colors[e],i=new v;Object.defineProperty(t.colors,e,{get:function(){return i.depend(),n},set:function(e){var t=n;n=e,i.notify(t)}})}),v.watcher(function(){t.strip.update(t.colors.hsl.hue,!0)}),v.watcher(function(){t.alphaSlider.update(t.colors.rgb.alpha,!0)}),v.watcher(function(){t.updateInputsModel(t.colors.model)}),v.watcher(function(){t.el.value=t.colors.current,t.guide.style.color=t.colors.current,t.guide.style.fill=t.colors.current})}},{key:"_initElements",value:function(){this.mouse={x:0,y:0},this.lastMove={x:0,y:0},this.isMenuActive=!1,this.menu=p('<div class="picker-menu" tabindex="-1"></div>'),this.guide=p('<button class="picker-guide">'+this.settings.guideIcon+"</button>"),this._initPicker(),this._initControllers(),this.el.classList.add("picker-value"),this.picker.classList.add("picker"),this.el.parentNode.insertBefore(this.picker,this.el),this.menu.appendChild(this.controllers),this.picker.appendChild(this.el),this.picker.appendChild(this.menu),this.picker.appendChild(this.guide),this.closePicker()}},{key:"_initControllers",value:function(){var n=this;this.controllers=p('<div class="picker-controllers"></div>'),this.strip=new g({min:0,max:360,step:1,classes:["is-strip"]}),this.alphaSlider=new g({min:0,max:1,step:.1,value:1,classes:["is-alpha"]}),this.controllers.appendChild(this.strip.wrapper),this.controllers.appendChild(this.alphaSlider.wrapper);this.strip.el.addEventListener("input",function(e){n.colors.hsl.hue=e.target.value||0,n.selectColor(n.colors.hsl)}),this.alphaSlider.el.addEventListener("input",function(e){var t=function(e,t){if(t=Number(t),isNaN(t)||1<t||t<0)return"Invalid alpha";var n=C(e);if("rgb"===n){var i=e.red,a=e.green,s=e.blue;return new M({red:i,green:a,blue:s,alpha:t})}if("hex"===n){var r=e.red,o=e.green,l=e.blue;return new x({red:r,green:o,blue:l,alpha:O(255*t)})}if("hsl"===n){var c=e.hue,u=e.sat,d=e.lum;return new A({hue:c,sat:u,lum:d,alpha:t})}return"Invalid color"}(n.colors.current,e.target.value||1);n.selectColor(t)})}},{key:"_initPicker",value:function(){var d=this;this.square=p('\n      <div class="picker-square">\n        <canvas class="picker-canvas"></canvas>\n        <div class="picker-cursor"></div>\n      </div>'),this.picker=document.createElement("div"),this.canvas=this.square.querySelector(".picker-canvas"),this.cursor=this.square.querySelector(".picker-cursor"),this.ctx=this.canvas.getContext("2d"),this.menu.appendChild(this.square),this.canvas.width=250,this.canvas.height=150,this.pickerRect=this.canvas.getBoundingClientRect();var t=function(e){var t=e.x,n=e.y,i=d.pickerRect,a=i.left,s=i.top,r={x:Math.min(Math.max(t-a,0),d.canvas.width-1),y:Math.min(Math.max(n-s,0),d.canvas.height)};d.mouse={x:r.x,y:r.y};var o=d.getColorCanvas(d.mouse,d.ctx),l=o.red,c=o.green,u=o.blue;d.colors.rgb.red=l,d.colors.rgb.green=c,d.colors.rgb.blue=u,d.selectColor(d.colors.rgb),d.updateCursor(d.mouse)};this.updateSquareColors(),this.canvas.addEventListener("mousedown",function(e){return((i=e).preventDefault(),d.pickerRect=d.canvas.getBoundingClientRect(),function(t){t(i);var n=function(e){window.requestAnimationFrame(function(){return t(e)})};document.addEventListener("mousemove",n),document.addEventListener("mouseup",function e(){document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",e)})})(t);var i})}},{key:"_initInputs",value:function(){var i=this;this.inputsWrapper=p('<div class="picker-inputs"></div>'),this.modelSwitcher=p('<button class="picker-model"></button>'),this.submit=p('\n    <button class="picker-submit">\n      <svg class="icon" viewBox="0 0 24 24">\n        <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>\n      </svg>\n    </button>'),this.controllers.appendChild(this.inputsWrapper),this.modelSwitcher.addEventListener("click",function(e){var t=["hex","rgb","hsl"],n=t.indexOf(i.colors.model);i.colors.model=t[n+1]||t[0],i.selectColor(i.colors.current)}),this.submit.addEventListener("click",function(e){m(i.settings.events.beforeSubmit),i.selectColor(i.colors[i.colors.model]),i.closePicker(),m(i.settings.events.afterSubmit)})}},{key:"updateInputsModel",value:function(e){var n=this;if(this.inputsWrapper.innerHTML="",this.modelSwitcher.innerText=e+": ",this.inputsWrapper.appendChild(this.modelSwitcher),"hsl"===e&&(this.inputs={hue:p('<input type="number" min="0" max="360" class="picker-input"/>'),sat:p('<input type="number" min="0" max="100" class="picker-input"/>'),lum:p('<input type="number" min="0" max="100" class="picker-input"/>')},Object.keys(this.inputs).forEach(function(e){var t=n.inputs[e];n.inputsWrapper.appendChild(t),t.value=n.colors.hsl[e],t.addEventListener("change",function(){n.colors.hsl[e]=t.value,n.selectColor(n.colors.hsl),n.updateCursor()})})),"rgb"===e&&(this.inputs={red:p('<input type="number" min="0" max="255" class="picker-input"/>'),green:p('<input type="number" min="0" max="255" class="picker-input"/>'),blue:p('<input type="number" min="0" max="255" class="picker-input"/>')},Object.keys(this.inputs).forEach(function(e){var t=n.inputs[e];n.inputsWrapper.appendChild(t),t.value=n.colors.rgb[e],t.addEventListener("change",function(){n.colors.rgb[e]=t.value,n.selectColor(n.colors.rgb),n.updateCursor()})})),"hex"===e){this.inputs={hex:p('<input type="text" class="picker-input"/>')};var t=this.inputs.hex;this.inputsWrapper.appendChild(t),t.addEventListener("change",function(){n.colors.hex=t.value,n.selectColor(n.colors.hex),n.updateCursor()}),t.value=this.colors.hex.toString()}this.inputsWrapper.appendChild(this.submit)}},{key:"_initEvents",value:function(){var s=this;this.guide.addEventListener("click",function(){m(s.settings.events.beforeOpen),s.togglePicker()}),this.settings.menu.draggable&&this.menu.addEventListener("mousedown",function(e){if(e.target===s.menu&&0===e.button){var t={},n={},i={};e.preventDefault(),t.x=e.clientX,t.y=e.clientY;var a=function(e){window.requestAnimationFrame(function(){n.x=e.clientX,n.y=e.clientY,i.x=s.lastMove.x+n.x-t.x,i.y=s.lastMove.y+n.y-t.y,s.menu.style.transform="translate("+i.x+"px, "+i.y+"px)"})};document.addEventListener("mousemove",a),document.addEventListener("mouseup",function e(){s.lastMove=i,document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",e)})}})}},{key:"updateSquareColors",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="hsl("+this.colors.hsl.hue+", 100%, 50%)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);var e=this.ctx.createLinearGradient(0,0,this.canvas.width,0);e.addColorStop(0,"hsl(0, 0%, 50%)"),e.addColorStop(1,"hsla(0, 0%, 50%, 0)"),this.ctx.fillStyle=e,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);var t=this.ctx.createLinearGradient(0,0,0,this.canvas.height);t.addColorStop(0,"hsl(0, 0%, 100%)"),t.addColorStop(.5,"hsla(0, 0%, 100%, 0)"),t.addColorStop(.5,"hsla(0, 0%, 0%, 0)"),t.addColorStop(1,"hsl(0, 0%, 0%) "),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"updateCursor",value:function(e){if(e)this.cursor.style.transform="translate3d("+e.x+"px, "+e.y+"px, 0)";else{var t=this.colors.hsl.sat/100*this.canvas.width,n=(100-this.colors.hsl.lum)/100*this.canvas.height;this.mouse={x:t,y:n},this.cursor.style.transform="translate3d("+t+"px, "+n+"px, 0)"}}},{key:"selectColor",value:function(e){var t,n,i,a,s=this,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];(this.muted=r,m(this.settings.events.beforeSelect),"rgb"===(n=C(t=e))?_(t).invalid:"hex"===n?S(t).invalid:"hsl"!==n||j(t).invalid)||(this.colors.rgb="hex"===(a=C(i=e))?I(i):"hsl"===a?P(i):"rgb"===a&&"string"==typeof i?_(i):"rgb"===a&&"object"===(void 0===i?"undefined":f(i))?i:new M,this.colors.hsl=N(e),this.colors.hex=F(e),this.colors.current=this.colors[this.colors.model],this.updateSquareColors(),r||(m(this.settings.events.afterSelect),this.events.forEach(function(e){return s.el.dispatchEvent(e)})))}},{key:"getColorCanvas",value:function(e,t){var n=t.getImageData(e.x,e.y,1,1).data;return{red:n[0],green:n[1],blue:n[2]}}},{key:"togglePicker",value:function(){this.isMenuActive?this.closePicker():this.openPiker()}},{key:"closePicker",value:function(){this.menu.classList.add("is-hidden"),this.isMenuActive=!1,document.removeEventListener("mousedown",this.documentCallback)}},{key:"openPiker",value:function(){var t=this;this.menu.classList.remove("is-hidden"),this.isMenuActive=!0;this.documentCallback=function(e){u(e.target,t.menu)||u(e.target,t.guide)?m(t.settings.events.clicked):t.closePicker()}.bind(this),document.addEventListener("mousedown",this.documentCallback),m(this.settings.events.afterOpen)}}]),n}();q.defaults={defaultColor:"#fff",model:"rgb",events:{},menu:{draggable:!0,hideWhenSubmit:!0},guideIcon:'<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="12"/></svg>'};var R=function(){function i(){c(this,i)}return a(i,null,[{key:"selectRange",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:i.textRange;if(e){var t=i.current;t.removeAllRanges(),t.addRange(e)}}},{key:"selectElement",value:function(e){if(e){var t=document.createRange();t.selectNodeContents(e);var n=i.current;n.removeAllRanges(),n.addRange(t)}}},{key:"clear",value:function(){i.current.empty()}},{key:"update",value:function(){var e=i.current;e.anchorNode&&!e.anchorNode.parentNode.closest(".align-content")||(e.rangeCount&&3===e.anchorNode.nodeType&&(i.textRange=e.getRangeAt(0)),e.rangeCount&&(i.range=e.getRangeAt(0)))}},{key:"current",get:function(){return i._current||window.getSelection()}}]),i}();R._current=null,R.textRange=null,R.range=null;var B=function(){function n(e,t){c(this,n),this.$align=e,this.mode=t&&1===t.nodeType?"edit":"create"}return a(n,[{key:"remove",value:function(){var e=document.createElement("p");this.el.parentNode.replaceChild(e,this.el),this.el.remove(),this.toolbar&&this.toolbar.remove()}}],[{key:"add",value:function(){return!1}}]),n}();B.list=[];var D=function(){function n(e,t){c(this,n),this.settings=Object.assign({},n.defaults,t),this.$align=e,this._init(this.settings.message,this.settings.data)}return a(n,[{key:"_init",value:function(e,t){var n=this,i=this.settings.position;this.el=document.createElement("div"),this.message=document.createElement("label"),this.inputs=[],this.buttons={},this.el.classList.add("prompt"),this.message.classList.add("prompt-message"),i&&(this.el.style.left=i.left+"px",this.el.style.top=i.top+"px"),i||(this.el.style.opacity=0,3===R.range.startContainer.nodeType&&(this.selectionReference=R.range),1===R.range.startContainer.nodeType&&(this.selectionReference=R.range.startContainer),setTimeout(function(){d(n.selectionReference,n.el,"left-top"),n.el.style.opacity=""},1)),this.message.innerText=e,this.el.appendChild(this.message);for(var a=0;a<this.settings.inputsCount;a++)this.inputs[a]=document.createElement("input"),this.inputs[a].type=this.settings.inputsTypes[a]||"text",this.inputs[a].classList.add("prompt-input"),this.settings.inputsPlaceholders[a]&&(this.inputs[a].placeholder=this.settings.inputsPlaceholders[a]),this.el.appendChild(this.inputs[a]);this.inputs[0].value=t,this.$align.wrapper.appendChild(this.el),this.callbackFunc=function(e){u(e.target,n.el)||n.remove()},setTimeout(function(){document.addEventListener("click",n.callbackFunc)},1)}},{key:"on",value:function(e,t,n){var i=this;return this.buttons[e]=document.createElement("button"),this.buttons[e].classList.add("prompt-button"),this.buttons[e].innerText=e,this.buttons[e].addEventListener("click",function(){t(n),i.remove()}),this.el.appendChild(this.buttons[e]),this}},{key:"onSubmit",value:function(e,t){return this.on("submit",e,t)}},{key:"onDelete",value:function(e,t){return this.on("delete",e,t)}},{key:"onCancel",value:function(e,t){return this.on("cancel",e,t)}},{key:"remove",value:function(){this.el.remove(),document.removeEventListener("click",this.callbackFunc)}}]),n}();D.defaults={message:"",data:"",position:null,inputsCount:1,inputsTypes:[],inputsPlaceholders:[]};var W=function(e){function i(e,t){c(this,i);var n=r(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments));return"create"===n.mode&&(n.el=document.createElement("a"),n.el.appendChild(R.range.extractContents()),R.range.insertNode(n.el)),"edit"===n.mode&&(n.el=t),n._init(),n}return n(i,B),a(i,[{key:"_init",value:function(){this.el.target="_blank",this.el.addEventListener("click",this.edit.bind(this))}},{key:"edit",value:function(){var t=this,n=new D(this.$align,{message:"Enter link:",data:this.el.getAttribute("href")});n.on("save",function(){var e=n.inputs[0].value;e&&t.update(e)}),this.el.href&&n.on("remove",function(){t.remove()})}},{key:"update",value:function(e){this.el.href=e,this.$align.$bus.emit("changed")}},{key:"remove",value:function(){var e=this.el.innerHTML;this.el.insertAdjacentHTML("beforebegin",e),t(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"remove",this).call(this)}}],[{key:"add",value:function(n){return new Promise(function(e,t){new i(n).edit(),e({})})}}]),i}();W.schema={tooltip:"Hyperlink",icon:"link"};var Z={sidebar:{element:"button",tooltip:"Show sidebar",func:"toggleSidebar",icon:"gear"},bold:{element:"button",command:"bold",tooltip:"Bold",shortcut:{cmdKey:!0,key:"B"}},italic:{element:"button",command:"italic",tooltip:"Italic",shortcut:{cmdKey:!0,key:"I"}},underline:{element:"button",command:"underline",tooltip:"Underline",shortcut:{cmdKey:!0,key:"U"}},strikeThrough:{element:"button",command:"strikeThrough",tooltip:"Strike through"},undo:{element:"button",command:"undo",tooltip:"Undo",shortcut:{cmdKey:!0,key:"Z"}},redo:{element:"button",command:"redo",tooltip:"Redo",shortcut:{cmdKey:!0,shiftKey:!0,key:"Z"}},removeFormat:{element:"button",command:"removeFormat",tooltip:"Remove format",shortcut:{cmdKey:!0,key:"\\"}},justifyLeft:{element:"button",command:"justifyLeft",tooltip:"Align left",shortcut:{cmdKey:!0,key:"L"}},justifyCenter:{element:"button",command:"justifyCenter",tooltip:"Align center",shortcut:{cmdKey:!0,key:"E"}},justifyRight:{element:"button",command:"justifyRight",tooltip:"Align right",shortcut:{cmdKey:!0,key:"R"}},selectContent:{element:"button",tooltip:"Select all content",shortcut:{cmdKey:!0,shiftKey:!0,key:"A"},func:function(e){R.selectElement(e.$align.editor)}},justifyFull:{element:"button",command:"justifyFull",tooltip:"Justify full",shortcut:{cmdKey:!0,key:"J"}},h1:{element:"button",command:"formatblock",value:"h1",tooltip:"Heading 1"},h2:{element:"button",command:"formatblock",value:"h2",tooltip:"Heading 2"},h3:{element:"button",command:"formatblock",value:"h3",tooltip:"Heading 3"},h4:{element:"button",command:"formatblock",value:"h4",tooltip:"Heading 4"},blockquote:{element:"button",command:"formatblock",value:"blockquote",tooltip:"Quote"},p:{element:"button",command:"formatblock",value:"p",tooltip:"Paragraph"},orderedList:{element:"button",command:"insertOrderedList",tooltip:"Ordered list"},unorderedList:{element:"button",command:"insertUnorderedList",tooltip:"Unordered list"},indent:{element:"button",command:"indent",useCSS:!0,tooltip:"Indent",shortcut:{key:"TAB"}},outdent:{element:"button",command:"outdent",useCSS:!0,tooltip:"Outdent",shortcut:{shiftKey:!0,key:"TAB"}},superscript:{element:"button",command:"superscript",tooltip:"Superscript",shortcut:{cmdKey:!0,shiftKey:!0,key:"+"}},subscript:{element:"button",command:"subscript",tooltip:"Subscript",shortcut:{cmdKey:!0,key:"="}},pre:{element:"button",command:"formatblock",value:"pre",func:"highlight",tooltip:"Script"},fontSize:{element:"select",command:"fontSize"},fontName:{element:"select",init:"applyFont",command:"fontName",useCSS:!0},separator:{element:"styling",class:"styler-separator"},addLink:{element:"button",icon:"link",func:"addElement",args:W},fullscreen:{element:"button",func:"toggleFullScreen",tooltip:"Fullscreen",shortcut:{cmdKey:!0,shiftKey:!0,key:"F"}},color:{element:"input",type:"text",command:"foreColor",tooltip:"Font color",useCSS:!0,init:q,initConfig:{guideIcon:'\n        <svg viewBox="0 0 24 24">\n          <path d="M0 20h24v4H0z"/>\n          <path style="fill: currentColor" d="M11 3L5.5 17h2.25l1.12-3h6.25l1.12 3h2.25L13 3h-2zm-1.38 9L12 5.67 14.38 12H9.62z"/>\n        </svg>\n      ',events:{beforeSubmit:function(){R.selectRange()},afterOpen:function(){R.update()}}}},backColor:{element:"input",type:"text",command:"backColor",tooltip:"Highlight color",useCSS:!0,init:q,initConfig:{guideIcon:'\n        <svg viewBox="0 0 24 24">\n          <path style="fill: currentColor" d="M16.56 8.94L7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10L10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5z"/>\n          <path d="M0 20h24v4H0z"/>\n        </svg>\n      ',events:{beforeSubmit:function(){R.selectRange()},afterOpen:function(){R.update()},afterSelect:function(){R.update()}}}},remove:{element:"button",func:"remove",tooltip:"Remove element",icon:"remove"},_sectionUp:{element:"button",func:"moveUp",tooltip:"Move up",icon:"caretUp"},_sectionDown:{element:"button",func:"moveDown",tooltip:"Move down",icon:"caretDown"},_sectionToggleHTML:{element:"button",func:"toggleHTML",tooltip:"Edit as HTMl",icon:"toggleHTML"},_sectionDuplicate:{element:"button",func:"duplicate",tooltip:"Duplicate section",icon:"duplicate"},_columnColor:{element:"input",type:"text",func:"columnColor",tooltip:"Change background color",init:q,initConfig:{defaultColor:"#000000",guideIcon:'\n        <svg viewBox="0 0 24 24">\n          <path d="M0 20h24v4H0z"/>\n          <path style="fill: currentColor" d="M17.5,12A1.5,1.5 0 0,1 16,10.5A1.5,1.5 0 0,1 17.5,9A1.5,1.5 0 0,1 19,10.5A1.5,1.5 0 0,1 17.5,12M14.5,8A1.5,1.5 0 0,1 13,6.5A1.5,1.5 0 0,1 14.5,5A1.5,1.5 0 0,1 16,6.5A1.5,1.5 0 0,1 14.5,8M9.5,8A1.5,1.5 0 0,1 8,6.5A1.5,1.5 0 0,1 9.5,5A1.5,1.5 0 0,1 11,6.5A1.5,1.5 0 0,1 9.5,8M6.5,12A1.5,1.5 0 0,1 5,10.5A1.5,1.5 0 0,1 6.5,9A1.5,1.5 0 0,1 8,10.5A1.5,1.5 0 0,1 6.5,12M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A1.5,1.5 0 0,0 13.5,19.5C13.5,19.11 13.35,18.76 13.11,18.5C12.88,18.23 12.73,17.88 12.73,17.5A1.5,1.5 0 0,1 14.23,16H16A5,5 0 0,0 21,11C21,6.58 16.97,3 12,3Z"/>\n        </svg>\n      '}}},K=new Proxy({blockquote:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z",bold:"M13.5,15.5H10V12.5H13.5A1.5,1.5 0 0,1 15,14A1.5,1.5 0 0,1 13.5,15.5M10,6.5H13A1.5,1.5 0 0,1 14.5,8A1.5,1.5 0 0,1 13,9.5H10M15.6,10.79C16.57,10.11 17.25,9 17.25,8C17.25,5.74 15.5,4 13.25,4H7V18H14.04C16.14,18 17.75,16.3 17.75,14.21C17.75,12.69 16.89,11.39 15.6,10.79Z",fontSize:"M9 4v3h5v12h3V7h5V4H9zm-6 8h3v7h3v-7h3V9H3v3z",h1:"M3,4H5V10H9V4H11V18H9V12H5V18H3V4M14,18V16H16V6.31L13.5,7.75V5.44L16,4H18V16H20V18H14Z",h2:"M3,4H5V10H9V4H11V18H9V12H5V18H3V4M21,18H15A2,2 0 0,1 13,16C13,15.47 13.2,15 13.54,14.64L18.41,9.41C18.78,9.05 19,8.55 19,8A2,2 0 0,0 17,6A2,2 0 0,0 15,8H13A4,4 0 0,1 17,4A4,4 0 0,1 21,8C21,9.1 20.55,10.1 19.83,10.83L15,16H21V18Z",h3:"M3,4H5V10H9V4H11V18H9V12H5V18H3V4M15,4H19A2,2 0 0,1 21,6V16A2,2 0 0,1 19,18H15A2,2 0 0,1 13,16V15H15V16H19V12H15V10H19V6H15V7H13V6A2,2 0 0,1 15,4Z",h4:"M3,4H5V10H9V4H11V18H9V12H5V18H3V4M18,18V13H13V11L18,4H20V11H21V13H20V18H18M18,11V7.42L15.45,11H18Z",html:"M19 12h-2v3h-3v2h5v-5zM7 9h3V7H5v5h2V9zm14-6H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16.01H3V4.99h18v14.02z",italic:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z",justifyCenter:"M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z",justifyFull:"M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zm0-6v2h18V3H3z",justifyLeft:"M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z",justifyRight:"M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z",p:"M13,4A4,4 0 0,1 17,8A4,4 0 0,1 13,12H11V18H9V4H13M13,10A2,2 0 0,0 15,8A2,2 0 0,0 13,6H11V10H13Z",pre:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z",removeFormat:"M15 16h4v2h-4zm0-8h7v2h-7zm0 4h6v2h-6zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3v10zM14 5h-3l-1-1H6L5 5H2v2h12z",strikeThrough:"M23,12V14H18.61C19.61,16.14 19.56,22 12.38,22C4.05,22.05 4.37,15.5 4.37,15.5L8.34,15.55C8.37,18.92 11.5,18.92 12.12,18.88C12.76,18.83 15.15,18.84 15.34,16.5C15.42,15.41 14.32,14.58 13.12,14H1V12H23M19.41,7.89L15.43,7.86C15.43,7.86 15.6,5.09 12.15,5.08C8.7,5.06 9,7.28 9,7.56C9.04,7.84 9.34,9.22 12,9.88H5.71C5.71,9.88 2.22,3.15 10.74,2C19.45,0.8 19.43,7.91 19.41,7.89Z",text:"M5 17v2h14v-2H5zm4.5-4.2h5l.9 2.2h2.1L12.75 4h-1.5L6.5 15h2.1l.9-2.2zM12 5.98L13.87 11h-3.74L12 5.98z",underline:"M5,21H19V19H5V21M12,17A6,6 0 0,0 18,11V3H15.5V11A3.5,3.5 0 0,1 12,14.5A3.5,3.5 0 0,1 8.5,11V3H6V11A6,6 0 0,0 12,17Z",unorderedList:"M7,5H21V7H7V5M7,13V11H21V13H7M4,4.5A1.5,1.5 0 0,1 5.5,6A1.5,1.5 0 0,1 4,7.5A1.5,1.5 0 0,1 2.5,6A1.5,1.5 0 0,1 4,4.5M4,10.5A1.5,1.5 0 0,1 5.5,12A1.5,1.5 0 0,1 4,13.5A1.5,1.5 0 0,1 2.5,12A1.5,1.5 0 0,1 4,10.5M7,19V17H21V19H7M4,16.5A1.5,1.5 0 0,1 5.5,18A1.5,1.5 0 0,1 4,19.5A1.5,1.5 0 0,1 2.5,18A1.5,1.5 0 0,1 4,16.5Z",orderedList:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z",indent:"M3 21h18v-2H3v2zM3 8v8l4-4-4-4zm8 9h10v-2H11v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z",outdent:"M11 17h10v-2H11v2zm-8-5l4 4V8l-4 4zm0 9h18v-2H3v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z",superscript:"M16 18.6L14.6 20 9 14.4 3.4 20 2 18.6 7.6 13 2 7.4 3.4 6 9 11.6 14.6 6 16 7.4 10.4 13l5.6 5.6zm2.3-14.2c0-.2.1-.4.1-.6.1-.2.2-.3.3-.4.1-.1.3-.2.4-.3.2-.1.4-.1.5-.1.2 0 .3 0 .4.1.1.1.3.1.3.2.1.1.2.2.2.4.1.1.1.3.1.5s-.1.4-.2.6c-.1.2-.2.3-.4.5-.2.1-.4.3-.6.4-.2.1-.5.3-.7.4-.2.1-.5.3-.7.4s-.2.3-.4.5-.3.3-.4.5c-.1.2-.2.4-.2.7V9h5V8h-3.8c.1-.2.3-.4.5-.6.3-.2.6-.4.8-.6s.6-.4.9-.5c.3-.2.6-.4.8-.6s.4-.5.6-.7c.1-.3.2-.6.2-.9 0-.3 0-.5-.1-.8s-.2-.5-.4-.7c-.2-.2-.4-.3-.7-.5-.4 0-.7-.1-1.2-.1-.4 0-.7.1-1 .2s-.6.3-.8.5c-.2.2-.4.5-.5.8-.2.2-.3.5-.3.9h1.3z",subscript:"M16 16.6L14.6 18 9 12.4 3.4 18 2 16.6 7.6 11 2 5.4 3.4 4 9 9.6 14.6 4 16 5.4 10.4 11l5.6 5.6zm2.3.8c0-.2.1-.4.1-.6.1-.2.2-.3.3-.4.1-.1.3-.2.4-.3s.3-.1.5-.1.3 0 .4.1c.1.1.3.1.3.2.1.1.2.2.2.4s.1.3.1.5-.1.4-.2.6c-.1.2-.2.3-.4.5-.2.1-.4.3-.6.4-.2.1-.5.3-.7.4-.2.1-.5.3-.7.4s-.4.3-.6.5c-.2.2-.3.3-.4.5-.1.2-.2.4-.2.6v.9h5v-1H18c.1-.2.3-.4.5-.6.2-.2.5-.4.8-.5s.6-.4.9-.5c.3-.2.6-.4.8-.6s.4-.5.6-.7c.2-.3.2-.6.2-.9 0-.3 0-.5-.1-.8s-.2-.5-.4-.7c-.2-.2-.4-.3-.7-.5-.3-.1-.7-.2-1.1-.2-.4 0-.7.1-1 .2-.3.1-.6.3-.8.5-.2.2-.4.5-.5.8-.1.3-.2.6-.3 1h1.4z",link:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z",selectContent:"M9,9H15V15H9M7,17H17V7H7M15,5H17V3H15M15,21H17V19H15M19,17H21V15H19M19,9H21V7H19M19,21A2,2 0 0,0 21,19H19M19,13H21V11H19M11,21H13V19H11M9,3H7V5H9M3,17H5V15H3M5,21V19H3A2,2 0 0,0 5,21M19,3V5H21A2,2 0 0,0 19,3M13,3H11V5H13M3,9H5V7H3M7,21H9V19H7M3,13H5V11H3M3,5H5V3A2,2 0 0,0 3,5Z",line:"M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3 3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z",undo:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z",redo:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z",plus:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z",video:"M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z",videoPlus:"M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5M14,13H11V16H9V13H6V11H9V8H11V11H14V13Z",image:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z",imageMultiple:"M22,16V4A2,2 0 0,0 20,2H8A2,2 0 0,0 6,4V16A2,2 0 0,0 8,18H20A2,2 0 0,0 22,16M11,12L13.03,14.71L16,11L20,16H8M2,6V20A2,2 0 0,0 4,22H18V20H4V6",imagePlus:"M5,3A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H14.09C14.03,20.67 14,20.34 14,20C14,19.32 14.12,18.64 14.35,18H5L8.5,13.5L11,16.5L14.5,12L16.73,14.97C17.7,14.34 18.84,14 20,14C20.34,14 20.67,14.03 21,14.09V5C21,3.89 20.1,3 19,3H5M19,16V19H16V21H19V24H21V21H24V19H21V16H19Z",imageBroken:"M21,5V11.59L18,8.58L14,12.59L10,8.59L6,12.59L3,9.58V5A2,2 0 0,1 5,3H19A2,2 0 0,1 21,5M18,11.42L21,14.43V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V12.42L6,15.41L10,11.41L14,15.41",imageOff:"M2.28,3L1,4.27L3,6.27V19A2,2 0 0,0 5,21H17.73L19.73,23L21,21.72L2.28,3M4.83,3L21,19.17V5C21,3.89 20.1,3 19,3H4.83M8.5,13.5L11,16.5L12,15.25L14.73,18H5L8.5,13.5Z",figure:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z",figureRight:"M15,7H21V13H15V7M3,3H21V5H3V3M13,7V9H3V7H13M9,11V13H3V11H9M3,15H17V17H3V15M3,19H21V21H3V19Z",figureCenter:"M9,7H15V13H9V7M3,3H21V5H3V3M3,15H21V17H3V15M3,19H17V21H3V19Z",figureLeft:"M3,7H9V13H3V7M3,3H21V5H3V3M21,7V9H11V7H21M21,11V13H11V11H21M3,15H17V17H3V15M3,19H21V21H3V19Z",figureFull:"M23 18V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zM8.5 12.5l2.5 3.01L14.5 11l4.5 6H5l3.5-4.5z",table:"M5,4H19A2,2 0 0,1 21,6V18A2,2 0 0,1 19,20H5A2,2 0 0,1 3,18V6A2,2 0 0,1 5,4M5,8V12H11V8H5M13,8V12H19V8H13M5,14V18H11V14H5M13,14V18H19V14H13Z",sectionNormal:"M12.5,19.5V3.47H14.53V19.5H12.5M9.5,19.5V3.47H11.53V19.5H9.5M4.5,7.5L8.53,11.5L4.5,15.47V12.47H1.5V10.5H4.5V7.5M19.5,15.47L15.5,11.5L19.5,7.5V10.5H22.5V12.47H19.5V15.47Z",sectionFull:"M9,11H15V8L19,12L15,16V13H9V16L5,12L9,8V11M2,20V4H4V20H2M20,20V4H22V20H20Z",section:"M2 21h19v-3H2v3zM20 8H3c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h17c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zM2 3v3h19V3H2z",fullscreen:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z",column:"M16,5V18H21V5M4,18H9V5H4M10,18H15V5H10V18Z",close:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z",delete:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z",facebook:"M5,3H19A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3M18,5H15.5A3.5,3.5 0 0,0 12,8.5V11H10V14H12V21H15V14H18V11H15V9A1,1 0 0,1 16,8H18V5Z",twitter:'"M5,3H19A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3M17.71,9.33C18.19,8.93 18.75,8.45 19,7.92C18.59,8.13 18.1,8.26 17.56,8.33C18.06,7.97 18.47,7.5 18.68,6.86C18.16,7.14 17.63,7.38 16.97,7.5C15.42,5.63 11.71,7.15 12.37,9.95C9.76,9.79 8.17,8.61 6.85,7.16C6.1,8.38 6.75,10.23 7.64,10.74C7.18,10.71 6.83,10.57 6.5,10.41C6.54,11.95 7.39,12.69 8.58,13.09C8.22,13.16 7.82,13.18 7.44,13.12C7.81,14.19 8.58,14.86 9.9,15C9,15.76 7.34,16.29 6,16.08C7.15,16.81 8.46,17.39 10.28,17.31C14.69,17.11 17.64,13.95 17.71,9.33Z',embed:"M12.89,3L14.85,3.4L11.11,21L9.15,20.6L12.89,3M19.59,12L16,8.41V5.58L22.42,12L16,18.41V15.58L19.59,12M1.58,12L8,5.58V8.41L4.41,12L8,15.58V18.41L1.58,12",tableRowTop:"M22,14A2,2 0 0,0 20,12H4A2,2 0 0,0 2,14V21H4V19H8V21H10V19H14V21H16V19H20V21H22V14M4,14H8V17H4V14M10,14H14V17H10V14M20,14V17H16V14H20M11,10H13V7H16V5H13V2H11V5H8V7H11V10Z",tableRowBottom:"M22,10A2,2 0 0,1 20,12H4A2,2 0 0,1 2,10V3H4V5H8V3H10V5H14V3H16V5H20V3H22V10M4,10H8V7H4V10M10,10H14V7H10V10M20,10V7H16V10H20M11,14H13V17H16V19H13V22H11V19H8V17H11V14Z",tableColumnBefore:"M13,2A2,2 0 0,0 11,4V20A2,2 0 0,0 13,22H22V2H13M20,10V14H13V10H20M20,16V20H13V16H20M20,4V8H13V4H20M9,11H6V8H4V11H1V13H4V16H6V13H9V11Z",tableColumnAfter:"M11,2A2,2 0 0,1 13,4V20A2,2 0 0,1 11,22H2V2H11M4,10V14H11V10H4M4,16V20H11V16H4M4,4V8H11V4H4M15,11H18V8H20V11H23V13H20V16H18V13H15V11Z",tableDeleteColumn:"M4,2H11A2,2 0 0,1 13,4V20A2,2 0 0,1 11,22H4A2,2 0 0,1 2,20V4A2,2 0 0,1 4,2M4,10V14H11V10H4M4,16V20H11V16H4M4,4V8H11V4H4M17.59,12L15,9.41L16.41,8L19,10.59L21.59,8L23,9.41L20.41,12L23,14.59L21.59,16L19,13.41L16.41,16L15,14.59L17.59,12Z",tableDeleteRow:"M9.41,13L12,15.59L14.59,13L16,14.41L13.41,17L16,19.59L14.59,21L12,18.41L9.41,21L8,19.59L10.59,17L8,14.41L9.41,13M22,9A2,2 0 0,1 20,11H4A2,2 0 0,1 2,9V6A2,2 0 0,1 4,4H20A2,2 0 0,1 22,6V9M4,9H8V6H4V9M10,9H14V6H10V9M16,9H20V6H16V9Z",remove:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z",duplicate:"M11,17H4A2,2 0 0,1 2,15V3A2,2 0 0,1 4,1H16V3H4V15H11V13L15,16L11,19V17M19,21V7H8V13H6V7A2,2 0 0,1 8,5H19A2,2 0 0,1 21,7V21A2,2 0 0,1 19,23H8A2,2 0 0,1 6,21V19H8V21H19Z",button:"M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z",split:"M8,18H11V15H2V13H22V15H13V18H16L12,22L8,18M12,2L8,6H11V9H2V11H22V9H13V6H16L12,2Z",gear:"M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z",dotsVertical:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",caretUp:"M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z",caretDown:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z",toggleHTML:"M14.6,16.6L19.2,12L14.6,7.4L16,6L22,12L16,18L14.6,16.6M9.4,16.6L4.8,12L9.4,7.4L8,6L2,12L8,18L9.4,16.6Z",youtube:"M10,15L15.19,12L10,9V15M21.56,7.17C21.69,7.64 21.78,8.27 21.84,9.07C21.91,9.87 21.94,10.56 21.94,11.16L22,12C22,14.19 21.84,15.8 21.56,16.83C21.31,17.73 20.73,18.31 19.83,18.56C19.36,18.69 18.5,18.78 17.18,18.84C15.88,18.91 14.69,18.94 13.59,18.94L12,19C7.81,19 5.2,18.84 4.17,18.56C3.27,18.31 2.69,17.73 2.44,16.83C2.31,16.36 2.22,15.73 2.16,14.93C2.09,14.13 2.06,13.44 2.06,12.84L2,12C2,9.81 2.16,8.2 2.44,7.17C2.69,6.27 3.27,5.69 4.17,5.44C4.64,5.31 5.5,5.22 6.82,5.16C8.12,5.09 9.31,5.06 10.41,5.06L12,5C16.19,5 18.8,5.16 19.83,5.44C20.73,5.69 21.31,6.27 21.56,7.17Z",vimeo:"M22,7.42C21.91,9.37 20.55,12.04 17.92,15.44C15.2,19 12.9,20.75 11,20.75C9.85,20.75 8.86,19.67 8.05,17.5C7.5,15.54 7,13.56 6.44,11.58C5.84,9.42 5.2,8.34 4.5,8.34C4.36,8.34 3.84,8.66 2.94,9.29L2,8.07C3,7.2 3.96,6.33 4.92,5.46C6.24,4.32 7.23,3.72 7.88,3.66C9.44,3.5 10.4,4.58 10.76,6.86C11.15,9.33 11.42,10.86 11.57,11.46C12,13.5 12.5,14.5 13.05,14.5C13.47,14.5 14.1,13.86 14.94,12.53C15.78,11.21 16.23,10.2 16.29,9.5C16.41,8.36 15.96,7.79 14.94,7.79C14.46,7.79 13.97,7.9 13.46,8.12C14.44,4.89 16.32,3.32 19.09,3.41C21.15,3.47 22.12,4.81 22,7.42Z"},{get:function(e,t){if(e[t])return'\n      <svg class="align-icon" viewBox="0 0 24 24">\n        <path d="'+e[t]+'"/>\n      </svg>'},set:function(e,t,n){return e[t]=n,!0}}),U=function(e){function s(e,t){c(this,s);var n=r(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments));return n.el=document.createElement("div"),n.el.classList.add("align-embed"),n.el.insertAdjacentHTML("afterbegin",t),n}return n(s,B),a(s,null,[{key:"add",value:function(i){var a=new D(i,{message:"Add an embedded:"});return new Promise(function(t,n){a.onSubmit(function(){var e=a.inputs[0].value;e||n("not a valid number"),t(new s(i,e))})})}}]),s}();U.schema={icon:"embed",tooltip:"Add embed"};var G=function(e){function s(e,t){c(this,s);var n=r(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments));return n.el=document.createElement("div"),n.el.classList.add("align-post"),n._init(t),n}return n(s,B),a(s,[{key:"_init",value:function(e){this.addFacebookSDK();var t=p('<div class="fb-post" data-width="600px" data-href="'+e+'"></div>');this.el.appendChild(t),setTimeout(function(){FB.init({appId:"align",xfbml:!0,version:"v3.1"})},300)}},{key:"addFacebookSDK",value:function(){var e="facebook-jssdk";if(!document.getElementById(e)){var t=document.createElement("script"),n=document.getElementsByTagName("script")[0];t.id=e,t.src="https://connect.facebook.net/es_LA/sdk.js",n.parentNode.insertBefore(t,n)}}}],[{key:"add",value:function(i){var a=new D(i,{message:"Enter post link:"});return new Promise(function(t,n){a.onSubmit(function(){var e=a.inputs[0].value;e||n("no link provided"),t(new s(i,e))})})}}]),s}();G.schema={icon:"facebook",tooltip:"Facebook post"};var X="align-";function Y(e){X=e}function J(e,t,n){var i=document.createElement("button");return i.classList.add(X+"button"),i.id=e,i.type="button",n&&(i.dataset.tooltip=n),i.insertAdjacentHTML("afterbegin",K[t]||t),i}function Q(n,e){var t=document.createElement("div"),i=document.createElement("select");return t.classList.add("align-select",n),i.id=n,e.forEach(function(e){var t=document.createElement("option");t.value=e,t.innerText=!1===e?n:e,i.appendChild(t)}),t.appendChild(i),t.insertAdjacentHTML("beforeend",'\n    <svg viewBox="0 0 24 24">\n      <polygon points="8,15 12,19 16,15 "/>\n      <polygon points="8,9 12,5 16,9 "/>\n    </svg>'),{wrapper:t,el:i}}function ee(e,t){var n=document.createElement("input");return n.classList.add(""+X+e),n.id=e,n.type=t,n}var te,ne={cmdKey:"Mac"===(te=e())?"⌘":"Ctrl",shift:"Mac"===te?"⇧":"Shift",ctrl:"Mac"===te?"⌃":"Ctrl",alt:"Mac"===te?"⌥":"Alt",tab:"Mac"===te?"⇥":"Tab"},ie=function(){function n(e,t){c(this,n),this.$align=e,this.settings=Object.assign({},n.defaults,t),this._init()}return a(n,[{key:"_init",value:function(){var t=this;Y("styler-"),this.cmdsSchema=function n(i){var a={};return Object.keys(i).forEach(function(e){var t=i[e];a[e]="object"!==(void 0===t?"undefined":s(t))||Array.isArray(t)?t:n(t)}),a}(Z),this.el=document.createElement("div"),this.menu=document.createElement("ul"),this.el.classList.add("styler","is-"+this.settings.mode,"is-"+this.settings.theme),this.el.appendChild(this.menu),this.menu.classList.add("styler-menu"),this.cmds={},this.visible=!1,this.shortcuts=[],this.watchers=[],this.settings.commands.forEach(function(e){t._initCmdElement(e)}),"bubble"===this.settings.mode&&(this.el.classList.add("is-hidden"),this.$align.wrapper.appendChild(this.el)),"toolbar"===this.settings.mode&&this.$align.el.insertAdjacentElement("afterbegin",this.el),"toolbar"===this.settings.mode&&this.settings.shortcuts&&this.keyboardShortcuts(),this.settings.hideWhenClickOut&&(this.clickCallback=function(e){u(e.target,t.el)||u(e.target,t.currentItem.el)||t.hide()})}},{key:"_initClassesElement",value:function(e){var h=this,p=e.el,m=e.schema,g=m.values;if(!Array.isArray(g)){var n=ee("counter","number"),i=g.min||0,a=g.max||12;return n.addEventListener("input",function(){if(h.currentItem){var e=Math.min(Math.max(n.value,i),a),t=h.currentItem.currentValue||0;h.toggleClass(e,[t]),h.currentItem.currentValue=e}}),this.watchers.push(function(){h.currentItem&&(n.value=h.currentItem.currentValue||"")}),void p.appendChild(n)}g.forEach(function(e,t){var n,i,a,s,r,o,l=e,c=m.icons?m.icons[t]:e,u=K[c]||e,d=(i=u,a=function(){h.toggleClass(l,g)},s=n=l,r=document.createElement("li"),(o=J(n,i,s)).addEventListener("click",a),r.appendChild(o),r);p.appendChild(d)})}},{key:"_initCmdElement",value:function(e){var t=this,n="string"==typeof e?e:Object.keys(e)[0],i=this.cmdsSchema[n]||e;if(i){var a,s,r,o,l,c="",u=document.createElement("li"),d=K[i.icon]||K[n]||n,h=this.getTooltip(i),p=this.cmds[n]={schema:i};switch(i.element){case"button":c=p.el=J(n,d,h);var m=function(){return t.cmdCallback(i,i.value)};p.el.addEventListener("click",m),i.shortcut&&this.shortcuts.push(Object.assign({},i.shortcut,{callback:m}));break;case"file":var g=(a=n,s=d,r=h,o=document.createElement("div"),l=document.createElement("input"),r&&(o.dataset.tooltip=r),o.classList.add(X+"button"),o.id=a,o.appendChild(l),o.insertAdjacentHTML("afterbegin",s),l.classList.add(X+"input"),l.id=a,l.type="file",{input:l,el:o});c=p.el=g.el,g.input.addEventListener("change",function(e){t.cmdCallback(i,e)});break;case"input":c=p.el=ee(n,i.type),p.el.addEventListener("change",function(){t.cmdCallback(i,p.el.value)});break;case"select":var v=Q(n,e[n]),f=v.wrapper,b=v.el;c=f,(p.el=b).addEventListener("change",function(){return t.cmdCallback(i,b[b.selectedIndex].value)});break;case"dropdown":var y=function(e,t,n){var i=document.createElement("div"),a=document.createElement("div"),s=X;X="dropdown-";var r=J(e);X=s;var o=[];return i.classList.add("dropdown"),i.id=e,a.classList.add("dropdown-menu"),t.forEach(function(e){var t=document.createElement("a");t.classList.add("dropdown-item"),t.addEventListener("click",function(){return n(e)}),o.push(t),t.innerHTML=e,a.appendChild(t)}),r.insertAdjacentHTML("beforeend",'\n    <svg viewBox="0 0 24 24" class="dropdown-caret">\n      <polygon points="6,10 12,17 18,10 "/>\n    </svg>'),r.addEventListener("click",function(){return i.classList.toggle("is-active")}),i.appendChild(r),i.appendChild(a),{dropdown:i,items:o}}(n,i.items,function(e){return t.cmdCallback(i,e)});c=p.el=y.dropdown;break;case"styling":u.classList.add(i.class);break;case"custom":c=i.create(this);break;case"classes":c=p.el=document.createElement("ul"),this._initClassesElement(p);break;default:console.warn(n," is not found")}c&&u.appendChild(c),"function"==typeof i.init&&(i.init=new i.init(p.el,i.initConfig)),"string"==typeof i.init&&(this.$align[i.init](i,e),i.init=null),this.menu.appendChild(u)}else console.warn(n+" is not found")}},{key:"cmdCallback",value:function(e,t){if(e.command&&this.execute(e.command,t,e.useCSS),"string"==typeof e.func){var n=null;if(this.$align[e.func]?n=this.$align[e.func].bind(this.$align):this.currentItem&&this.currentItem[e.func]&&(n=this.currentItem[e.func].bind(this.currentItem)),!n)return void console.warn(e.func," is not found");n(e.args||t)}"function"==typeof e.func&&e.func(e.args||t),this.update()}},{key:"keyboardShortcuts",value:function(){var i=this;this.cmdKey="Mac"===e()?"metaKey":"ctrlKey",window.addEventListener("keydown",function(t){if(!t.defaultPrevented){var n=t.key.toUpperCase();i.shortcuts.forEach(function(e){n===e.key&&t[i.cmdKey]===!!e.cmdKey&&t.shiftKey===!!e.shiftKey&&(t.preventDefault(),e.callback())})}})}},{key:"execute",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this.$align.editor.focus(),document.execCommand("styleWithCSS",!1,n),document.execCommand(e,!1,t),document.execCommand("styleWithCSS",!1,!1),this.$align.update()}},{key:"updateBubble",value:function(e){if(R.range&&!R.range.collapsed&&R.range===R.current.getRangeAt(0)||this.currentItem){var t=this.currentItem?this.currentItem.el:R.range;return this.currentPosition=d(t,this.el,e||this.settings.position),void this.show()}this.hide()}},{key:"show",value:function(){var t=this;if(!this.visible){this.visible=!0,this.el.style.transition="opacity 0.2s",this.el.classList.add("is-visible"),this.el.classList.remove("is-hidden");this.currentItem&&this.currentItem.el&&this.currentItem.el.addEventListener("transitionend",function e(){t.el.style.transition="",t.el.removeEventListener("transitionend",e)}),this.settings.hideWhenClickOut&&document.addEventListener("click",this.clickCallback)}}},{key:"hide",value:function(){this.currentItem&&this.settings.addActiveClass&&this.currentItem.el.classList.remove("is-active"),this.currentItem&&(this.currentItem=null),this.el.classList.remove("is-visible"),this.el.classList.remove("is-active"),this.el.classList.add("is-hidden"),this.visible=!1,this.settings.hideWhenClickOut&&document.removeEventListener("click",this.clickCallback)}},{key:"update",value:function(e){this.currentItem&&this.settings.addActiveClass&&this.currentItem.el.classList.remove("is-active"),e&&this.settings.addActiveClass&&e.el.classList.add("is-active"),e&&(this.currentItem=e),this.watchers.forEach(function(e){return e()}),this.updateCommandsStates(),"bubble"===this.settings.mode&&this.updateBubble()}},{key:"remove",value:function(){var e=this;setTimeout(function(){e.el.remove()},1)}},{key:"getTooltip",value:function(e){if(!e.tooltip||!this.settings.tooltip)return!1;if(this.settings.shortcuts&&e.shortcut){var t=e.shortcut,n=[t.cmdKey?ne.cmdKey:"",t.shiftKey?ne.shift:"","TAB"===t.key?ne.tab:t.key].join(" ");return e.tooltip+" ("+n+")"}return e.tooltip}},{key:"updateCommandsStates",value:function(){var i=this;Object.values(this.cmds).forEach(function(e){var t=e.schema,n=t.command;if(t.active){if(t.active.split(".").reduce(function(e,t){if(e)return e[t]},i))return void e.el.classList.add("is-active");e.el.classList.remove("is-active")}if(n)if(document.queryCommandState(n))e.el.classList.add("is-active");else if(document.queryCommandValue(n)!==t.value)if(t.init){if(!R.current.anchorNode)return;(1===R.current.anchorNode.type?R.current.anchorNode:R.current.anchorNode.parentNode).closest(".align-content")&&(document.queryCommandValue(n),t.init.selectColor(document.queryCommandValue(n),!0))}else document.queryCommandValue(n)&&(e.el.value=document.queryCommandValue(n)),e.el.classList.remove("is-active");else e.el.classList.add("is-active")})}},{key:"toggleClass",value:function(e,t){var n,i=this;if(this.currentItem){var a=t.map(function(e){return"is-"+e});if((n=this.currentItem.el.classList).remove.apply(n,o(a)),e){this.currentItem.el.classList.toggle("is-"+e);this.currentItem.el.addEventListener("transitionend",function e(){i.update(),i.currentItem.el.removeEventListener("transitionend",e)}),this.$align.$bus.emit("changed")}}}}]),n}();ie.defaults={mode:"toolbar",commands:[],hideWhenClickOut:!1,tooltip:!1,theme:"light",shortcuts:!1,addActiveClass:!1,position:"center-top"};var ae=function(e){function s(e,t){c(this,s);var n=r(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments));return"create"===n.mode&&(n.el=document.createElement("figure"),n.caption=document.createElement("figcaption"),n.img=document.createElement("img"),n.readFileContent(t)),"edit"===n.mode&&(n.el=t,n.caption=t.querySelector("figcaption")||document.createElement("figcaption"),n.img=t.querySelector("img")),n._init(),n}return n(s,B),a(s,[{key:"_init",value:function(){var e=this;this.toolbar=new ie(this.$align,s.toolbar),this.el.contentEditable=!1,this.caption.contentEditable=!0,this.caption.dataset.defaultValue="Figure caption",this.img.classList.add("align-image"),this.el.classList.add("align-figure","is-center"),this.el.appendChild(this.img),this.el.appendChild(this.caption),this.el.addEventListener("click",function(){e.toolbar.update(e)})}},{key:"readFileContent",value:function(e){var t=this;if(!this.isImage(e.name))return{el:null};this.img.src=URL.createObjectURL(e);this.$align.$bus.emit("imageAdded",{file:e,update:function(e){t.img.src=e,t.$align.$bus.emit("changed")}})}},{key:"isImage",value:function(e){switch(e.split(".").slice(-1)[0].toLowerCase()){case"jpg":case"jpge":case"gif":case"bmp":case"png":return!0}return!1}}],[{key:"add",value:function(i){var a=new D(i,{message:"Chose image figure:",inputsTypes:["file"]});return new Promise(function(t,n){a.onSubmit(function(){var e=a.inputs[0].files[0];e||n("no file provided"),t(new s(i,e))})})}},{key:"render",value:function(e){var t=e,n=e.querySelector("figcaption"),i=e.querySelector("img");t.contentEditable="inherit",t.classList.remove("is-active"),n.contentEditable="inherit",n.removeAttribute("data-default-value"),i.removeAttribute("data-align-filename"),""===n.innerText&&n.remove()}}]),s}();ae.toolbar={mode:"bubble",hideWhenClickOut:!0,addActiveClass:!0,tooltip:!0,commands:[{element:"classes",values:["floatLeft","center","floatRight","full"],icons:["figureLeft","figureCenter","figureRight","figureFull"]},"remove"]},ae.schema={icon:"figure",tooltip:"Add Figure"};var se=function(e){function l(e,t){c(this,l);var n=r(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments));return n.el=document.createElement("div"),n.el.classList.add("align-gallery"),n.images=t,n._init(),n}return n(l,B),a(l,[{key:"_init",value:function(){var i=this;Array.from(this.images).forEach(function(e){var t=URL.createObjectURL(e),n=p('<img class="align-gallery-image"/>');n.src=t,i.el.appendChild(n),i.$align.$bus.emit("imageAdded",{file:e,update:function(e){n.src=e,i.$align.$bus.emit("changed")}})})}}],[{key:"add",value:function(n){var e,t,i,a=R.range.startContainer,s=(e=document.createElement("div"),t=document.createElement("input"),i=document.createElement("span"),e.classList.add("align-dropzone"),e.appendChild(t),e.appendChild(i),t.classList.add("align-dropzone-input"),t.type="file",t.multiple=!0,i.classList.add("align-dropzone-description"),i.innerHTML="Click here to upload your image",{input:t,el:e}),r=s.el,o=s.input;return a.appendChild(r,a),new Promise(function(e,t){o.addEventListener("change",function(){r.remove(),e(new l(n,o.files))})})}}]),l}();se.schema={icon:"imageMultiple",tooltip:"Add gallery"};var re=function(e){function s(e,t){c(this,s);var n=r(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments));return"create"===n.mode&&(n.el=document.createElement("div"),n.el.classList.add("align-grid"),n.el.insertAdjacentHTML("afterbegin",'<div class="align-column"><p></p></div>'.repeat(t))),"edit"===n.mode&&(n.el=t),n._init(),n}return n(s,B),a(s,[{key:"_init",value:function(){var n=this;this.columns=Array.from(this.el.querySelectorAll(".align-column")),this.gridToolbar=new ie(this.$align,s.gridToolbar),this.columnToolbar=new ie(this.$align,s.columnToolbar),this.el.addEventListener("click",function(){n.gridToolbar.update(n)}),this.columns.forEach(function(e){var t={el:e,columnColor:n.columnColor.bind(n)};e.addEventListener("click",function(){n.columnToolbar.update(t)})})}},{key:"columnColor",value:function(e){this.columnToolbar.currentItem.el.style.backgroundColor=e,this.$align.$bus.emit("changed")}},{key:"remove",value:function(){this.gridToolbar.remove(),this.columnToolbar.remove(),t(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"remove",this).call(this)}}],[{key:"add",value:function(i){var a=new D(i,{message:"Enter columns count:",inputsCount:1});return new Promise(function(t,n){a.onSubmit(function(){var e=a.inputs[0].value;isNaN(e)&&n("not a valid number"),t(new s(i,e))})})}}]),s}();re.gridToolbar={mode:"bubble",hideWhenClickOut:!0,commands:[{element:"classes",values:["center","shrink","relaxed"]},"remove"]},re.columnToolbar={mode:"bubble",position:"center-bottom",hideWhenClickOut:!0,commands:["_columnColor",{element:"classes",values:"input"}]},re.schema={icon:"column",tooltip:"Add columns"};var oe=function(e){function i(e,t){c(this,i);var n=r(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments));return n.el=document.createElement("p"),n}return n(i,B),a(i,null,[{key:"add",value:function(n){return new Promise(function(e,t){e(new i(n))})}}]),i}();oe.schema={icon:"p",tooltip:"Line separator"};var le=function(e){function i(e,t){c(this,i);var n=r(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments));return"create"===n.mode&&(n.el=document.createElement("hr"),n.el.classList.add("align-line")),"edit"===n.mode&&(n.el=t),n._init(),n}return n(i,B),a(i,[{key:"_init",value:function(){var e=this;this.toolbar=new ie(this.$align,i.toolbar),this.el.addEventListener("click",function(){e.toolbar.update(e)})}}],[{key:"add",value:function(n){return new Promise(function(e,t){e(new i(n))})}}]),i}();le.toolbar={mode:"bubble",hideWhenClickOut:!0,commands:[{element:"classes",values:["normal","dashed","dotted","double","dots","thick"]},"remove"]},le.schema={icon:"line",tooltip:"Line separator"};var ce=function(e){function i(e){c(this,i);var t=r(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments));return t.el=document.createElement("blockquote"),t.quote=document.createElement("p"),t.author=document.createElement("cite"),t.el.classList.add("align-quote"),t.quote.dataset.defaultValue="Quote...",t.author.dataset.defaultValue="author",t.el.contentEditable="false",t.quote.contentEditable="true",t.author.contentEditable="true",t.el.appendChild(t.quote),t.el.appendChild(t.author),t}return n(i,B),a(i,null,[{key:"add",value:function(n){return new Promise(function(e,t){e(new i(n))})}}]),i}();ce.schema={icon:"blockquote",tooltip:"Quote"};var ue=function(e){function i(e,t){c(this,i);var n=r(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments));return"create"===n.mode&&(n.el=document.createElement("div"),n.el.classList.add("align-separator"),n.currentHeigh=50),"edit"===n.mode&&(n.el=t,n.currentHeigh=Number(n.el.style.height.slice(0,-2))),n._init(),n}return n(i,B),a(i,[{key:"_init",value:function(){this.updateHeight(this.currentHeigh),this.el.addEventListener("mousedown",this.handleClick.bind(this))}},{key:"updateHeight",value:function(e){this.el.style.height=e+"px",this.$align.$bus.emit("changed")}},{key:"handleClick",value:function(e){var n=this;e.preventDefault();var i=e.y,a=function(e){var t=e.y;n.delta=t-i,n.updateHeight(n.currentHeigh+n.delta)};window.addEventListener("mousemove",a),window.addEventListener("mouseup",function e(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",e),n.currentHeigh+=n.delta})}}],[{key:"add",value:function(n){return new Promise(function(e,t){e(new i(n))})}}]),i}();ue.schema={tooltip:"Vimeo",icon:"split"};var de="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var he,pe=(function(e){var c="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},u=function(){var l=/\blang(?:uage)?-([\w-]+)\b/i,t=0,j=c.Prism={manual:c.Prism&&c.Prism.manual,disableWorkerMessageHandler:c.Prism&&c.Prism.disableWorkerMessageHandler,util:{encode:function(e){return e instanceof r?new r(e.type,j.util.encode(e.content),e.alias):"Array"===j.util.type(e)?e.map(j.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e,n){var t=j.util.type(e);switch(n=n||{},t){case"Object":if(n[j.util.objId(e)])return n[j.util.objId(e)];a={};for(var i in n[j.util.objId(e)]=a,e)e.hasOwnProperty(i)&&(a[i]=j.util.clone(e[i],n));return a;case"Array":if(n[j.util.objId(e)])return n[j.util.objId(e)];var a=[];return n[j.util.objId(e)]=a,e.forEach(function(e,t){a[t]=j.util.clone(e,n)}),a}return e}},languages:{extend:function(e,t){var n=j.util.clone(j.languages[e]);for(var i in t)n[i]=t[i];return n},insertBefore:function(n,e,t,i){var a=(i=i||j.languages)[n];if(2==arguments.length){for(var s in t=e)t.hasOwnProperty(s)&&(a[s]=t[s]);return a}var r={};for(var o in a)if(a.hasOwnProperty(o)){if(o==e)for(var s in t)t.hasOwnProperty(s)&&(r[s]=t[s]);r[o]=a[o]}return j.languages.DFS(j.languages,function(e,t){t===i[n]&&e!=n&&(this[e]=r)}),i[n]=r},DFS:function(e,t,n,i){for(var a in i=i||{},e)e.hasOwnProperty(a)&&(t.call(e,a,e[a],n||a),"Object"!==j.util.type(e[a])||i[j.util.objId(e[a])]?"Array"!==j.util.type(e[a])||i[j.util.objId(e[a])]||(i[j.util.objId(e[a])]=!0,j.languages.DFS(e[a],t,a,i)):(i[j.util.objId(e[a])]=!0,j.languages.DFS(e[a],t,null,i)))}},plugins:{},highlightAll:function(e,t){j.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,n){var i={callback:n,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};j.hooks.run("before-highlightall",i);for(var a,s=i.elements||e.querySelectorAll(i.selector),r=0;a=s[r++];)j.highlightElement(a,!0===t,i.callback)},highlightElement:function(e,t,n){for(var i,a,s=e;s&&!l.test(s.className);)s=s.parentNode;s&&(i=(s.className.match(l)||[,""])[1].toLowerCase(),a=j.languages[i]),e.className=e.className.replace(l,"").replace(/\s+/g," ")+" language-"+i,e.parentNode&&(s=e.parentNode,/pre/i.test(s.nodeName)&&(s.className=s.className.replace(l,"").replace(/\s+/g," ")+" language-"+i));var r={element:e,language:i,grammar:a,code:e.textContent};if(j.hooks.run("before-sanity-check",r),!r.code||!r.grammar)return r.code&&(j.hooks.run("before-highlight",r),r.element.textContent=r.code,j.hooks.run("after-highlight",r)),void j.hooks.run("complete",r);if(j.hooks.run("before-highlight",r),t&&c.Worker){var o=new Worker(j.filename);o.onmessage=function(e){r.highlightedCode=e.data,j.hooks.run("before-insert",r),r.element.innerHTML=r.highlightedCode,n&&n.call(r.element),j.hooks.run("after-highlight",r),j.hooks.run("complete",r)},o.postMessage(JSON.stringify({language:r.language,code:r.code,immediateClose:!0}))}else r.highlightedCode=j.highlight(r.code,r.grammar,r.language),j.hooks.run("before-insert",r),r.element.innerHTML=r.highlightedCode,n&&n.call(e),j.hooks.run("after-highlight",r),j.hooks.run("complete",r)},highlight:function(e,t,n){var i={code:e,grammar:t,language:n};return j.hooks.run("before-tokenize",i),i.tokens=j.tokenize(i.code,i.grammar),j.hooks.run("after-tokenize",i),r.stringify(j.util.encode(i.tokens),i.language)},matchGrammar:function(e,t,n,i,a,s,r){var o=j.Token;for(var l in n)if(n.hasOwnProperty(l)&&n[l]){if(l==r)return;var c=n[l];c="Array"===j.util.type(c)?c:[c];for(var u=0;u<c.length;++u){var d=c[u],h=d.inside,p=!!d.lookbehind,m=!!d.greedy,g=0,v=d.alias;if(m&&!d.pattern.global){var f=d.pattern.toString().match(/[imuy]*$/)[0];d.pattern=RegExp(d.pattern.source,f+"g")}d=d.pattern||d;for(var b=i,y=a;b<t.length;y+=t[b].length,++b){var k=t[b];if(t.length>e.length)return;if(!(k instanceof o)){if(m&&b!=t.length-1){if(d.lastIndex=y,!(E=d.exec(e)))break;for(var L=E.index+(p?E[1].length:0),H=E.index+E[0].length,C=b,V=y,w=t.length;C<w&&(V<H||!t[C].type&&!t[C-1].greedy);++C)(V+=t[C].length)<=L&&(++b,y=V);if(t[b]instanceof o)continue;M=C-b,k=e.slice(y,V),E.index-=y}else{d.lastIndex=0;var E=d.exec(k),M=1}if(E){p&&(g=E[1]?E[1].length:0);H=(L=E.index+g)+(E=E[0].slice(g)).length;var A=k.slice(0,L),x=k.slice(H),_=[b,M];A&&(++b,y+=A.length,_.push(A));var S=new o(l,h?j.tokenize(E,h):E,v,E,m);if(_.push(S),x&&_.push(x),Array.prototype.splice.apply(t,_),1!=M&&j.matchGrammar(e,t,n,b,y,!0,l),s)break}else if(s)break}}}}},tokenize:function(e,t,n){var i=[e],a=t.rest;if(a){for(var s in a)t[s]=a[s];delete t.rest}return j.matchGrammar(e,i,t,0,0,!1),i},hooks:{all:{},add:function(e,t){var n=j.hooks.all;n[e]=n[e]||[],n[e].push(t)},run:function(e,t){var n=j.hooks.all[e];if(n&&n.length)for(var i,a=0;i=n[a++];)i(t)}}},r=j.Token=function(e,t,n,i,a){this.type=e,this.content=t,this.alias=n,this.length=0|(i||"").length,this.greedy=!!a};if(r.stringify=function(t,n,e){if("string"==typeof t)return t;if("Array"===j.util.type(t))return t.map(function(e){return r.stringify(e,n,t)}).join("");var i={type:t.type,content:r.stringify(t.content,n,e),tag:"span",classes:["token",t.type],attributes:{},language:n,parent:e};if(t.alias){var a="Array"===j.util.type(t.alias)?t.alias:[t.alias];Array.prototype.push.apply(i.classes,a)}j.hooks.run("wrap",i);var s=Object.keys(i.attributes).map(function(e){return e+'="'+(i.attributes[e]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+i.tag+' class="'+i.classes.join(" ")+'"'+(s?" "+s:"")+">"+i.content+"</"+i.tag+">"},!c.document)return c.addEventListener&&(j.disableWorkerMessageHandler||c.addEventListener("message",function(e){var t=JSON.parse(e.data),n=t.language,i=t.code,a=t.immediateClose;c.postMessage(j.highlight(i,j.languages[n],n)),a&&c.close()},!1)),c.Prism;var e=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return e&&(j.filename=e.src,j.manual||e.hasAttribute("data-manual")||("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(j.highlightAll):window.setTimeout(j.highlightAll,16):document.addEventListener("DOMContentLoaded",j.highlightAll))),c.Prism}();e.exports&&(e.exports=u),void 0!==de&&(de.Prism=u),u.languages.markup={comment:/<!--[\s\S]*?-->/,prolog:/<\?[\s\S]+?\?>/,doctype:/<!DOCTYPE[\s\S]+?>/i,cdata:/<!\[CDATA\[[\s\S]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+))?)*\s*\/?>/i,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+)/i,inside:{punctuation:[/^=/,{pattern:/(^|[^\\])["']/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},u.languages.markup.tag.inside["attr-value"].inside.entity=u.languages.markup.entity,u.hooks.add("wrap",function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),u.languages.xml=u.languages.markup,u.languages.html=u.languages.markup,u.languages.mathml=u.languages.markup,u.languages.svg=u.languages.markup,u.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(?:;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^{}\s][^{};]*?(?=\s*\{)/,string:{pattern:/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/[-_a-z\xA0-\uFFFF][-\w\xA0-\uFFFF]*(?=\s*:)/i,important:/\B!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},u.languages.css.atrule.inside.rest=u.languages.css,u.languages.markup&&(u.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\s\S]*?>)[\s\S]*?(?=<\/style>)/i,lookbehind:!0,inside:u.languages.css,alias:"language-css",greedy:!0}}),u.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|')(?:\\[\s\S]|(?!\1)[^\\])*\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:u.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:u.languages.css}},alias:"language-css"}},u.languages.markup.tag)),u.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(?:true|false)\b/,function:/[a-z0-9_]+(?=\()/i,number:/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},u.languages.javascript=u.languages.extend("clike",{keyword:/\b(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b(?:0[xX][\dA-Fa-f]+|0[bB][01]+|0[oO][0-7]+|NaN|Infinity)\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee][+-]?\d+)?/,function:/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*\()/i,operator:/-[-=]?|\+[+=]?|!=?=?|<<?=?|>>?>?=?|=(?:==?|>)?|&[&=]?|\|[|=]?|\*\*?=?|\/=?|~|\^=?|%=?|\?|\.{3}/}),u.languages.insertBefore("javascript","keyword",{regex:{pattern:/((?:^|[^$\w\xA0-\uFFFF."'\])\s])\s*)\/(\[[^\]\r\n]+]|\\.|[^/\\\[\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})\]]))/,lookbehind:!0,greedy:!0},"function-variable":{pattern:/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*=\s*(?:function\b|(?:\([^()]*\)|[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*)\s*=>))/i,alias:"function"},constant:/\b[A-Z][A-Z\d_]*\b/}),u.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\[\s\S]|\${[^}]+}|[^\\`])*`/,greedy:!0,inside:{interpolation:{pattern:/\${[^}]+}/,inside:{"interpolation-punctuation":{pattern:/^\${|}$/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}}}),u.languages.javascript["template-string"].inside.interpolation.inside.rest=u.languages.javascript,u.languages.markup&&u.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\s\S]*?>)[\s\S]*?(?=<\/script>)/i,lookbehind:!0,inside:u.languages.javascript,alias:"language-javascript",greedy:!0}}),u.languages.js=u.languages.javascript,"undefined"!=typeof self&&self.Prism&&self.document&&document.querySelector&&(self.Prism.fileHighlight=function(){var l={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"};Array.prototype.slice.call(document.querySelectorAll("pre[data-src]")).forEach(function(e){for(var t,n=e.getAttribute("data-src"),i=e,a=/\blang(?:uage)?-([\w-]+)\b/i;i&&!a.test(i.className);)i=i.parentNode;if(i&&(t=(e.className.match(a)||[,""])[1]),!t){var s=(n.match(/\.(\w+)$/)||[,""])[1];t=l[s]||s}var r=document.createElement("code");r.className="language-"+t,e.textContent="",r.textContent="Loading…",e.appendChild(r);var o=new XMLHttpRequest;o.open("GET",n,!0),o.onreadystatechange=function(){4==o.readyState&&(o.status<400&&o.responseText?(r.textContent=o.responseText,u.highlightElement(r)):400<=o.status?r.textContent="✖ Error "+o.status+" while fetching file: "+o.statusText:r.textContent="✖ Error: File does not exist or is empty")},o.send(null)}),u.plugins.toolbar&&u.plugins.toolbar.registerButton("download-file",function(e){var t=e.element.parentNode;if(t&&/pre/i.test(t.nodeName)&&t.hasAttribute("data-src")&&t.hasAttribute("data-download-link")){var n=t.getAttribute("data-src"),i=document.createElement("a");return i.textContent=t.getAttribute("data-download-link-label")||"Download",i.setAttribute("download",""),i.href=n,i}})},document.addEventListener("DOMContentLoaded",self.Prism.fileHighlight))}(he={exports:{}},he.exports),he.exports),me=function(){function i(e,t,n){c(this,i),this.settings=Object.assign({},i.defaults,n),this.el=e,this.el.contentEditable=!1,this.el.classList.add("align-codeEditor"),this._init(),this.textarea.value=t,this.changeLanguage(this.settings.language)}return a(i,[{key:"_init",value:function(){this.textarea=document.createElement("textarea"),this.wrapper=document.createElement("div"),this.pre=document.createElement("pre"),this.code=document.createElement("code"),this.textarea.classList.add("align-codeEditor-textarea"),this.wrapper.classList.add("align-codeEditor-wrapper"),this.pre.classList.add("align-codeEditor-pre"),this.code.classList.add("align-codeEditor-code"),this.textarea.spellcheck=!1,this.textarea.autocapitalize=!1,this.textarea.autocomplete=!1,this.textarea.autocorrect=!1,this.wrapper.appendChild(this.textarea),this.wrapper.appendChild(this.pre),this.el.appendChild(this.wrapper),this.pre.appendChild(this.code),this.textarea.addEventListener("input",this.highlight.bind(this)),this.textarea.addEventListener("scroll",this.handleScroll.bind(this)),this._initLangSelector()}},{key:"_initLangSelector",value:function(){var e=this,t=Q("langSelector",["javascript","html","css"]),n=t.wrapper,i=t.el;this.el.appendChild(n),i.addEventListener("change",function(){e.changeLanguage(i[i.selectedIndex].value)})}},{key:"changeLanguage",value:function(e){var t,n;this.settings.language=e,t=this.pre,n=new RegExp("\\b"+"language"+".*?\\b","g"),[].concat(o(t.classList)).map(function(e){n.test(e)&&t.classList.remove(e)}),this.pre.classList.add("language-"+this.settings.language),this.highlight()}},{key:"highlight",value:function(){var e=pe.highlight(this.textarea.value,pe.languages[this.settings.language]);this.code.innerHTML=e}},{key:"handleScroll",value:function(){var e=this.textarea.scrollTop,t=this.textarea.scrollLeft;this.pre.style.transform="translate("+-1*t+"px, "+-1*e+"px)"}}]),i}();me.defaults={language:"javascript"};var ge=function(e){function i(e,t){c(this,i);var n=r(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments));return"create"===n.mode&&(n.el=document.createElement("div"),n.content="hello world,",n.language="javascript"),"edit"===n.mode&&(n.el=t,n.content=n.el.querySelector("pre").innerText,n.el.innerHTML=""),n._init(),n}return n(i,B),a(i,[{key:"_init",value:function(){this.codeEditor=new me(this.el,this.content,{language:"javascript"})}}],[{key:"add",value:function(n){return new Promise(function(e,t){e(new i(n))})}},{key:"render",value:function(e){var t=e.querySelector("pre"),n=e.querySelector("code");e.innerText="",e.contentEditable="inherit",n.innerHTML=n.innerText,e.appendChild(t)}}]),i}();ge.toolbar={mode:"bubble",hideWhenClickOut:!0,commands:[{element:"classes",values:["js","css","html"]},"remove"]},ge.schema={icon:"script",tooltip:"Add Table"};var ve=function(e){function s(e,t){c(this,s);var n=r(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments));if("create"===n.mode){var i=Number(t.rows),a=Number(t.columns);if(isNaN(i)||isNaN(a))return r(n);n.el=document.createElement("table"),n.el.classList.add("align-table"),n.el.insertAdjacentHTML("afterbegin",("<tr>\n          "+"<td><br></td>".repeat(a)+"\n        </tr>").repeat(i))}return"edit"===n.mode&&(n.el=t),n._init(),n}return n(s,B),a(s,[{key:"_init",value:function(){var t=this;this.toolbar=new ie(this.$align,s.toolbar),this.activeCell=this.el.rows[0].cells[0],this.el.addEventListener("click",function(e){t.activeCell=e.target,t.toolbar.update(t)})}},{key:"insertRow",value:function(e){for(var t=e[0],n=this.el.rows[0].cells.length,i=this.activeCell.parentNode.rowIndex+("after"===t?1:0),a=this.el.insertRow(i),s=0;s<n;s++){a.insertCell(s).insertAdjacentHTML("afterbegin","<br>")}}},{key:"deleteRow",value:function(){this.el.deleteRow(this.activeCell.parentNode.rowIndex)}},{key:"insertColumn",value:function(e){for(var t=e[0],n=this.el.rows.length,i=this.activeCell.cellIndex+("after"===t?1:0),a=0;a<n;a++){this.el.rows[a].insertCell(i).insertAdjacentHTML("afterbegin","<br>")}}},{key:"deleteColumn",value:function(){for(var e=this.el.rows.length,t=this.activeCell.cellIndex,n=0;n<e;n++)this.el.rows[n].deleteCell(t)}}],[{key:"add",value:function(n){var i=new D(n,{message:"Enter post link:",inputsCount:2,inputsPlaceholders:["rows","columns"]});return new Promise(function(t,e){i.onSubmit(function(){var e=new s(n,{rows:i.inputs[0].value,columns:i.inputs[1].value});t(e)})})}}]),s}();ve.toolbar={mode:"bubble",hideWhenClickOut:!0,addActiveClass:!0,commands:[{element:"button",func:"insertRow",args:["before"],icon:"tableRowTop"},{element:"button",func:"insertRow",args:["after"],icon:"tableRowBottom"},{element:"button",func:"insertColumn",args:["before"],icon:"tableColumnBefore"},{element:"button",func:"insertColumn",args:["after"],icon:"tableColumnAfter"},"separator",{element:"button",func:"deleteRow",icon:"tableDeleteRow"},{element:"button",func:"deleteColumn",icon:"tableDeleteColumn"},"separator","remove"],tooltip:!0},ve.schema={icon:"table",tooltip:"Add Table"};var fe=function(e){function i(e,t){c(this,i);var n=r(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments));return"create"===n.mode&&(n.el=document.createElement("a"),n.el.classList.add("align-button"),n.span=document.createElement("span"),n.span.dataset.defaultValue="Button text",n.el.appendChild(n.span)),"edit"===n.mode&&(n.el=t),n._init(),n}return n(i,B),a(i,[{key:"_init",value:function(){var e=this;this.toolbar=new ie(this.$align,i.toolbar),this.el.addEventListener("click",function(){e.editLink(),e.toolbar.update(e)})}},{key:"editLink",value:function(){var t=this,n=new D(this.$align,{message:"Enter link:",data:this.el.getAttribute("href")});n.on("save",function(){var e=n.inputs[0].value;e&&(t.el.href=e)}),this.el.href&&n.on("clear",function(){t.el.href=""})}}],[{key:"add",value:function(n){return new Promise(function(e,t){e(new i(n))})}}]),i}();fe.toolbar={mode:"bubble",hideWhenClickOut:!0,addActiveClass:!0,position:"center-bottom",tooltip:!0,commands:[{element:"classes",values:["small","normal","large"]},"separator",{element:"classes",values:["primary","secondary","danger","success"]},"separator",{element:"classes",values:["outline","default"]},"separator","remove"]},fe.schema={icon:"button"};var be=function(e){function s(e,t){c(this,s);var n=r(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments));return n.el=document.createElement("div"),n.el.classList.add("align-video"),n._init(t),n}return n(s,B),a(s,[{key:"_init",value:function(e){var t=e.match(/vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)/);if(t){var n=t[1],i=document.createElement("iframe");i.allowfullscreen=!0,i.contentEditable=!1,i.src="//player.vimeo.com/video/"+n,this.el.appendChild(i)}else console.warn("wrong vimeo video url")}}],[{key:"add",value:function(i){var a=new D(i,{message:"Enter video link:"});return new Promise(function(t,n){a.onSubmit(function(){var e=a.inputs[0].value;e||n("no link provided"),t(new s(i,e))})})}}]),s}();be.schema={tooltip:"Vimeo",icon:"vimeo"};var ye=function(e){function s(e,t){c(this,s);var n=r(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments));return n.el=document.createElement("div"),n.el.classList.add("align-video"),n._init(t),n}return n(s,B),a(s,[{key:"_init",value:function(e){var t=e.match(/(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);if(t){var n=t[1],i=document.createElement("iframe");i.allowfullscreen=!0,i.contentEditable=!1,i.src="//www.youtube.com/embed/"+n,this.el.appendChild(i)}else console.warn("wrong youtube video url")}}],[{key:"add",value:function(i){var a=new D(i,{message:"Enter video link:"});return new Promise(function(t,n){a.onSubmit(function(){var e=a.inputs[0].value;e||n("no link provided"),t(new s(i,e))})})}}]),s}();ye.schema={tooltip:"Youtube",icon:"youtube"};var ke={Embed:U,Facebook:G,Figure:ae,Gallery:se,Grid:re,Paragraph:oe,Line:le,Link:W,Quote:ce,Separator:ue,Script:ge,Table:ve,Button:fe,Vimeo:be,Youtube:ye},Le=function(){function l(e,t){var n=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=i.position,s=i.type,r=void 0===s?"text":s;if(c(this,l),!t||"BR"!==t.nodeName){if(this.id=l.id++,this.$align=e,this.fields=["backgroundImage","backgroundVideo","backgroundColor","customClass","layout"],this.props={customClass:[],modifiers:[],backgroundColor:"",backgroundVideo:"",backgroundImage:"",parallax:!1,isHTMLView:!1,layout:{},type:r},"string"==typeof t&&(t=p(t)),this._initWrapper(t),"text"===this.props.type&&(this._initProps(),this._initBackground(t),this._initContent(t),this._initControllers(),this.el.addEventListener("click",function(){n.active()})),this._initContent(t),this._initWatchers(),"number"==typeof a){var o=this.$align.sections[a];return this.$align.editor.insertBefore(this.el,o.el),void this.$align.sections.splice(a,0,this)}this.$align.editor.appendChild(this.el),this.$align.sections.push(this)}}return a(l,[{key:"_initWrapper",value:function(e){var t,n=this;this.el=document.createElement("div"),this.el.classList.add("align-section");var i=e?e.classList:"";i&&((i=Array.from(i)).splice(i.indexOf("align-section"),1),i.forEach(function(e){e.startsWith("is-")?n.props.modifiers.push(e):e.startsWith("has-")||n.props.customClass.push(e)}),(t=this.el.classList).add.apply(t,o(this.props.modifiers)),this.el.setAttribute("style",e.getAttribute("style")),["margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left"].forEach(function(e){var t=n.el.style[e];t&&(n.props.layout[e]=t)}))}},{key:"_initContent",value:function(e){var t=this;switch(this.props.type){case"text":this.contentDiv||(this.contentDiv=document.createElement("div"),this.contentDiv.classList.add("align-content"),this.contentDiv.contentEditable=!0),this.props.isHTMLView&&(e=e.innerText),this.props.isHTMLView||(e=e?e.innerHTML:"<p></p>"),this.contentDiv.innerHTML=e,this.el.appendChild(this.contentDiv),this._initComponents();break;case"title":this.title=this.el.querySelector(".align-title")||document.createElement("h1"),this.title.classList.add("align-title"),this.title.contentEditable=!0,this.title.innerText=e,this.el.appendChild(this.title),this.title.addEventListener("blur",function(){t.title.innerHTML=t.title.innerText})}}},{key:"_initComponents",value:function(){var t=this,e=Array.from(this.contentDiv.querySelectorAll(".align-separator")),n=Array.from(this.contentDiv.querySelectorAll(".align-button")),i=Array.from(this.contentDiv.querySelectorAll(".align-grid")),a=Array.from(this.contentDiv.querySelectorAll(".align-line")),s=Array.from(this.contentDiv.querySelectorAll(".align-codeEditor")),r=Array.from(this.contentDiv.querySelectorAll("figure")),o=Array.from(this.contentDiv.querySelectorAll("table")),l=Array.from(this.contentDiv.querySelectorAll("a"));e.forEach(function(e){return new ue(t.$align,e)}),n.forEach(function(e){return new fe(t.$align,e)}),i.forEach(function(e){return new re(t.$align,e)}),a.forEach(function(e){return new le(t.$align,e)}),s.forEach(function(e){return new ge(t.$align,e)}),r.forEach(function(e){return new ae(t.$align,e)}),o.forEach(function(e){return new ve(t.$align,e)}),l.forEach(function(e){return new W(t.$align,e)})}},{key:"_initControllers",value:function(){var t=this;this.controllers=document.createElement("div"),this.addButton=document.createElement("button"),this.controllers.classList.add("align-sectionControllers"),this.addButton.classList.add("align-sectionAdd"),this.addButton.addEventListener("click",function(){var e=new l(t.$align,"",{position:t.getIndex()});setTimeout(function(){e.active(),R.selectElement(e.contentDiv.querySelector("p"))},1)}),this.controllers.appendChild(this.addButton),this.el.appendChild(this.controllers)}},{key:"_initBackground",value:function(e){if(e){var t=e.querySelector(".align-bgImage"),n=e.querySelector(".align-bgVideo"),i=e.querySelector(".align-bgColor");t&&(this.props.backgroundImage=t.style.backgroundImage,this.props.parallax=t.classList.contains("is-parallax"),console.log(this.props.backgroundImage),t.remove()),n&&(this.props.backgroundVideo=n.querySelector("source").src,n.remove()),i&&(this.props.backgroundColor=i.style.backgroundColor,i.remove())}}},{key:"_initProps",value:function(){var t=this;Object.keys(this.props).forEach(function(e){var n=t.props[e],i=new v;Object.defineProperty(t.props,e,{get:function(){return i.depend(),n},set:function(e){var t=n;n=e,i.notify(t)}})})}},{key:"_initWatchers",value:function(){var a=this;v.watcher(function(e){var t,n;e&&0<e.length&&(n=a.el.classList).remove.apply(n,o(e));if(0!==a.props.customClass.length){(t=a.el.classList).add.apply(t,o(a.props.customClass));var i=a.getIndex();a.$align.$bus.emit("changed"),a.$align.$bus.emit("sectionChanged",{from:i,to:i,props:a.props})}}),v.watcher(function(){a.backgroundColor(a.props.backgroundColor)}),v.watcher(function(){a.backgroundImage(a.props.backgroundImage)}),v.watcher(function(){a.backgroundVideo(a.props.backgroundVideo)}),v.watcher(function(){a.updateLayout(a.props.layout)}),v.watcher(function(){var e=a.props.parallax;a.bgImage&&a.bgImage.classList.toggle("is-parallax",e)})}},{key:"getIndex",value:function(){var t=this;return this.$align.sections.findIndex(function(e){return e===t})}},{key:"updateLayout",value:function(){var n=this;Object.keys(this.props.layout).forEach(function(e){var t=n.props.layout[e];if(t)return n.props.layout[e]=t,void(n.el.style[e]=t);delete n.props.layout[e],n.el.style[e]=""});var e=this.getIndex();this.$align.$bus.emit("changed"),this.$align.$bus.emit("sectionChanged",{from:e,to:e,props:this.props})}},{key:"toggleHTML",value:function(){if(!this.props.isHTMLView){this.props.isHTMLView=!0;var e=document.createTextNode(this.contentDiv.innerHTML),t=document.createElement("pre");return this.contentDiv.innerHTML="",t.dataset.alignHtml=!0,t.appendChild(e),void this.contentDiv.appendChild(t)}this._initContent(this.contentDiv),this.props.isHTMLView=!1}},{key:"backgroundColor",value:function(e){if(e&&"rgb(255,255,255)"!==e){this.bgColor||(this.bgColor=document.createElement("div"),this.bgColor.classList.add("align-bgColor"),this.el.insertBefore(this.bgColor,this.contentDiv)),this.bgColor.style.backgroundColor=e,this.el.classList.add("has-bgColor"),this.$align.update();var t=this.getIndex();this.$align.$bus.emit("changed"),this.$align.$bus.emit("sectionChanged",{from:t,to:t,props:this.props})}else this.bgColor&&(this.bgColor.remove(),this.bgColor=null,this.el.classList.remove("has-bgColor"))}},{key:"backgroundImage",value:function(e){var t=this;if(e){var n="";n=e instanceof File?URL.createObjectURL(e):e.match(/url\("(.+)"\)/)[1]||e,this.bgImage||(this.bgImage=document.createElement("div"),this.bgImage.classList.add("align-bgImage"),this.el.insertAdjacentElement("afterBegin",this.bgImage));this.bgImage.style.backgroundImage="url("+n+")",this.el.classList.add("has-bgImage"),this.$align.update();var i=this.getIndex();this.$align.$bus.emit("imageAdded",{file:e,update:function(e){t.bgImage.style.backgroundImage="url("+e+")"}}),this.$align.$bus.emit("changed"),this.$align.$bus.emit("sectionChanged",{from:i,to:i,props:this.props})}else this.bgImage&&(this.bgImage.remove(),this.bgImage=null,this.el.classList.remove("has-bgImage"))}},{key:"backgroundVideo",value:function(e){if(e){var t="";t=e instanceof File?URL.createObjectURL(e):e,this.bgVideo||(this.bgVideo=document.createElement("div"),this.bgVideo.classList.add("align-bgVideo"),this.bgVideo.insertAdjacentHTML("afterbegin","<video autoplay muted loop></video>"),this.el.insertAdjacentElement("afterbegin",this.bgVideo));var n=this.bgVideo.querySelector("source")||document.createElement("source"),i=this.bgVideo.querySelector("video");i.appendChild(n),n.src=t,i.load(),i.play(),this.el.classList.add("has-bgVideo");this.$align.update();var a=this.getIndex();this.$align.$bus.emit("videoAdded",{file:e,update:function(e){n.src=e}}),this.$align.$bus.emit("changed"),this.$align.$bus.emit("sectionChanged",{from:a,to:a,props:this.props})}else this.bgVideo&&(this.bgVideo.remove(),this.bgVideo=null,this.el.classList.remove("has-bgVideo"))}},{key:"moveUp",value:function(){var e=this.getIndex();this.$align.sections[e-1]&&"title"!==this.$align.sections[e-1].type&&(this.$align.editor.insertBefore(this.el,this.$align.sections[e-1].el),h(this.$align.sections,e,e-1),this.$align.$bus.emit("changed"),this.$align.$bus.emit("sectionChanged",{from:e,to:this.getIndex(),props:this.props}))}},{key:"moveDown",value:function(){var e=this.getIndex();this.$align.sections[e+1]&&(this.$align.editor.insertBefore(this.el,this.$align.sections[e+1].el.nextSibling),h(this.$align.sections,e,e+1),this.$align.$bus.emit("changed"),this.$align.$bus.emit("sectionChanged",{from:e,to:this.getIndex(),props:this.props}))}},{key:"active",value:function(){l.activeSection!==this&&this.contentDiv.focus(),l.activeSection&&l.activeSection.inactive(),(l.activeSection=this).el.classList.add("is-active"),this.$align.$sectionToolbar.update(this),this.$align.sidebar.update(),this.$align.update()}},{key:"inactive",value:function(){this.el.classList.remove("is-active")}},{key:"remove",value:function(){var e=this.getIndex();this.inactive(),this.el.remove(),this.$align.sections.splice(e,1),this.$align.$sectionToolbar.hide(),this.$align.update(),this.$align.$bus.emit("changed"),this.$align.$bus.emit("sectionChanged",{from:e,to:null})}},{key:"duplicate",value:function(){var e=this.content;new l(this.$align,e,{position:this.getIndex()});this.$align.$bus.emit("sectionChanged",{from:null,to:this.getIndex()}),this.$align.$bus.emit("changed")}},{key:"content",get:function(){var e=void 0;if("text"===this.props.type){var t=(e=this.el.cloneNode(!0)).querySelector(".align-sectionControllers"),n=e.querySelector(".align-content"),i=Array.from(n.querySelectorAll("figure")),a=Array.from(n.querySelectorAll(".align-codeEditor"));this.props.isHTMLView&&(n.innerHTML=n.innerText),i.forEach(function(e){return ae.render(e)}),a.forEach(function(e){return ge.render(e)}),e.classList.remove("is-active"),e.insertAdjacentHTML("beforeend",n.innerHTML),n.remove(),t.remove()}return"title"===this.props.type?this.title.innerText:e.outerHTML}}]),l}();Le.id=0,Le.activeSection=null,Le.defaults={mode:"bubble",hideWhenClickOut:!0,commands:["_sectionUp","_sectionDown","_sectionToggleHTML","_sectionDuplicate",{element:"classes",values:["normal","full"],icons:["sectionNormal","sectionFull"]},"remove"],tooltip:!0,position:"left-top"};var He=function(){function e(){c(this,e),this.events={}}return a(e,[{key:"on",value:function(e,t){var n=this;this.events[e]||(this.events[e]=[]);var i=this.events[e].length;return this.events[e].push(t),function(){n.events[e].splice(i,1)}}},{key:"once",value:function(e,t){var n=this,i=this.events.eventName?this.events[e].length:0;this.on(e,function(){t.apply(void 0,arguments),n.events[e].splice(i,1)})}},{key:"emit",value:function(e,t){var n=this;this.events[e]&&this.events[e].length&&setTimeout(function(){n.events[e].forEach(function(e){return e(t)})},0)}}]),e}(),Ce=function(){function n(e,t){c(this,n),this.$align=e,this.settings=Object.assign({},t),this._init(),this.hide()}return a(n,[{key:"_init",value:function(){Y("inserter-"),this.el=document.createElement("div"),this.menu=document.createElement("div"),this.list=document.createElement("ul"),this.toggleButton=J("inserter-toggle","plus"),this.el.classList.add("inserter"),this.menu.classList.add("inserter-menu"),this.list.classList.add("inserter-list"),this.toggleButton.classList.add("inserter-plus"),this.menu.appendChild(this.list),this.el.appendChild(this.toggleButton),this.el.appendChild(this.menu),this.visible=!1,this.$align.wrapper.appendChild(this.el),this.toggleButton.addEventListener("click",this.active.bind(this)),this._initComponents()}},{key:"_initComponents",value:function(){var s=this;this.components=Object.keys(ke),this.components.forEach(function(e){var t=document.createElement("li"),n=document.createElement("span"),i=ke[e].schema.icon,a=J(e,i);a.addEventListener("click",function(){s.$align.addElement(ke[e])}),a.appendChild(n),t.appendChild(a),n.innerText=e,s.list.appendChild(t)})}},{key:"update",value:function(e){if(R.range&&R.range.collapsed&&1===R.range.startContainer.nodeType&&R.range.startContainer.childNodes.length<=1&&R.range.startContainer.closest("p"))return this.position=d(R.range.startContainer,this.el,e||this.settings.position),void this.show();this.hide()}},{key:"active",value:function(){this.el.classList.toggle("is-active")}},{key:"toggleVisibility",value:function(){this.visible?this.hide():this.show()}},{key:"show",value:function(){this.el.classList.add("is-visible"),this.el.classList.remove("is-hidden"),this.visible=!0}},{key:"hide",value:function(){this.el.classList.remove("is-visible"),this.el.classList.remove("is-active"),this.el.classList.add("is-hidden"),this.visible=!1}},{key:"remove",value:function(){var e=this;setTimeout(function(){e.el.remove()},1)}}]),n}(),Ve=function(){function t(e){c(this,t),this.$align=e,this._init()}return a(t,[{key:"_init",value:function(){Y("align-sidebar-"),this.el=document.createElement("div"),this.el.classList.add("align-sidebar"),this.watchers=[]}},{key:"_initLayout",value:function(){var t=this;this.layout=this.generateElement("layout:",'\n      <div class="align-layout">\n        <div class="align-layout-margin">\n          <input class="align-layout-input is-top" placeholder="-" data-align-margin-top type="text">\n          <input class="align-layout-input is-left" placeholder="-" data-align-margin-left type="text">\n          <input class="align-layout-input is-right" placeholder="-" data-align-margin-right type="text">\n          <input class="align-layout-input is-bottom" placeholder="-" data-align-margin-bottom type="text">\n        </div>\n        <div class="align-layout-padding">\n          <input class="align-layout-input is-top" placeholder="-" data-align-padding-top type="text">\n          <input class="align-layout-input is-left" placeholder="-" data-align-padding-left type="text">\n          <input class="align-layout-input is-right" placeholder="-" data-align-padding-right type="text">\n          <input class="align-layout-input is-bottom" placeholder="-" data-align-padding-bottom type="text">\n        </div>\n      </div>\n    '),this.marginInputs={top:this.layout.querySelector("[data-align-margin-top]"),right:this.layout.querySelector("[data-align-margin-right]"),bottom:this.layout.querySelector("[data-align-margin-bottom]"),left:this.layout.querySelector("[data-align-margin-left]")},this.paddingInputs={top:this.layout.querySelector("[data-align-padding-top]"),right:this.layout.querySelector("[data-align-padding-right]"),bottom:this.layout.querySelector("[data-align-padding-bottom]"),left:this.layout.querySelector("[data-align-padding-left]")},Object.keys(this.marginInputs).forEach(function(e){var n="margin-"+e;t.marginInputs[e].value=t.currentProps.layout[n]||"",t.marginInputs[e].addEventListener("input",function(e){var t=Object.assign(Le.activeSection.props.layout,i({},n,e.target.value));Le.activeSection.props.layout=t})}),Object.keys(this.paddingInputs).forEach(function(e){var n="padding-"+e;t.paddingInputs[e].value=t.currentProps.layout[n]||"",t.paddingInputs[e].addEventListener("input",function(e){var t=Object.assign(Le.activeSection.props.layout,i({},n,e.target.value));Le.activeSection.props.layout=t})})}},{key:"element",value:function(e,t){if("switcher"===t){var n=p('\n        <label class="align-switcher" for="'+e+'">\n          <span class="align-switcher-info">'+e+'</span>\n          <input class="align-switcher-input" id="'+e+'" type="checkbox">\n          <span class="align-switcher-body">\n            <span class="align-switcher-handle"></span>\n          </span>\n        </label>\n      ');return{input:n.querySelector(".align-switcher-input"),elm:n}}}},{key:"field",value:function(e,t,n){var i=document.createElement("div"),a=document.createElement("label");if(i.classList.add("align-sidebar-field"),a.classList.add("align-sidebar-label"),a.innerText=t,i.appendChild(a),this.el.appendChild(i),"file"===n){var s=p('<div class="align-sidebar-file"></div>'),r=p('<label class="align-sidebar-label" for="'+e+'"></label>'),o=p('<input class="align-sidebar-input" id="'+e+'" type="file">'),l=p("<button>"+K.close+"</button>");return[r,o,l].forEach(function(e){s.appendChild(e)}),i.appendChild(s),l.addEventListener("click",function(){r.innerText="Add image",o.value="",o.dispatchEvent(new window.Event("change"))}),{input:o,label:r,close:l,el:i}}if("color"===n){var c=p('<div class="align-sidebar-colors"></div>'),u=p('<input class="align-sidebar-input" id="'+e+'" type="text">'),d=["black","white","gray","clear"];(d=d.map(function(e){return{el:p('<button class="align-sidebar-color is-'+e+'" type="text"><button>'),color:e}})).forEach(function(e){c.appendChild(e.el)}),c.appendChild(u);var h=new q(u,{guideIcon:'\n          <svg viewBox="0 0 24 24">\n            <circle cx="12" cy="12" r="11"></circle>\n          </svg>\n        '});return i.appendChild(c),{input:u,colorpikcer:h,colors:d}}}},{key:"generateElement",value:function(e,t){var n=document.createElement("div"),i=document.createElement("label");return n.classList.add("align-sidebar-field"),i.classList.add("align-sidebar-label"),i.innerText=e,this.el.appendChild(n),n.appendChild(i),n.insertAdjacentHTML("beforeend",t),n}},{key:"updateFields",value:function(){var t=this;this.el.innerHTML="",this.fields.forEach(function(e){switch(e){case"backgroundImage":t.backgroundImage=t.field("background-image","Background image:","file"),t.backgroundImage.input.addEventListener("change",function(e){Le.activeSection.props.backgroundImage=e.target.files[0]}),t.backgroundImage.label.innerText=t.currentProps.backgroundImage?t.currentProps.backgroundImage.name||t.currentProps.backgroundImage:"Add image",t.parallax=t.element("parallax","switcher"),t.backgroundImage.el.insertAdjacentElement("beforeend",t.parallax.elm),t.parallax.input.checked=t.currentProps.parallax,t.parallax.input.addEventListener("change",function(e){Le.activeSection.props.parallax=!!e.target.checked});break;case"backgroundVideo":t.backgroundVideo=t.field("background-video","Background video:","file"),t.backgroundVideo.input.addEventListener("change",function(e){Le.activeSection.props.backgroundVideo=e.target.files[0]}),t.backgroundVideo.label.innerText=t.currentProps.backgroundVideo?t.currentProps.backgroundVideo.name||t.currentProps.backgroundVideo:"Add video";break;case"backgroundColor":t.backgroundColor=t.field("background-color","Background color:","color"),t.backgroundColor.input.addEventListener("change",function(e){Le.activeSection.props.backgroundColor=e.target.value}),t.backgroundColor.colors.forEach(function(t){t.el.addEventListener("click",function(){var e=Le.activeSection;"clear"!==t.color&&(e.props.backgroundColor=t.color),"clear"===t.color&&(e.props.backgroundColor=null)})}),t.backgroundColor.colorpikcer.selectColor(t.currentProps.backgroundColor,!0);break;case"customClass":t.customClass=t.generateElement("Custom class:",'<input class="align-sidebar-input" data-align-input type="text">'),t.customClass=t.customClass.querySelector("[data-align-input]"),t.customClass.value=t.currentProps.customClass,t.customClass.addEventListener("input",function(){var e=this;Le.activeSection.props.customClass=e.value.split(/[ ,]+/).map(function(e){return e.trim()}).filter(function(e){return""!==e})});break;case"layout":t._initLayout()}})}},{key:"update",value:function(){this.currentProps=Le.activeSection.props,this.fields=Le.activeSection.fields,this.updateFields()}}]),t}(),we=function(){function n(e,t){c(this,n),this.el=l(e),this.settings=Object.assign({},n.defaults,t),this._init()}return a(n,[{key:"_init",value:function(){this.$bus=new He,this.startContent=Array.from(this.el.children),this.el.innerText="",document.execCommand("defaultParagraphSeparator",!1,"p"),this.cmdKey="Mac"===e()?"metaKey":"ctrlKey",this.cmdKeyPressed=!1,this._initEditor(),this._initStylers(),this._initSections(),this._initEvents(),this.sidebar=new Ve(this),this.el.appendChild(this.sidebar.el)}},{key:"_initStylers",value:function(){this.$sectionToolbar=new ie(this,Object.assign({},Le.defaults,this.settings.section)),this.settings.toolbar&&(this.toolbar=new ie(this,Object.assign({},this.settings.toolbar,{mode:"toolbar"}))),this.settings.bubble&&(this.bubble=new ie(this,Object.assign({},this.settings.bubble,{mode:"bubble",tooltip:!1}))),this.inserter=new Ce(this,{})}},{key:"_initEditor",value:function(){this.wrapper=document.createElement("div"),this.editor=document.createElement("div"),this.wrapper.classList.add("align-wrapper"),this.editor.classList.add("align-editor"),this.wrapper.appendChild(this.editor),this.el.appendChild(this.wrapper),this.editor.focus(),R.update()}},{key:"_initSections",value:function(){var t=this;!(this.sections=[])!==this.settings.postTitle&&(this.postTitle=new Le(this,this.settings.postTitle,{type:"title"})),this.startContent.forEach(function(e){return new Le(t,e)});var e=document.createElement("button");e.classList.add("align-sectionAdd","is-main"),this.wrapper.appendChild(e),e.addEventListener("click",function(){var e=new Le(t);setTimeout(function(){e.active(),R.selectElement(e.contentDiv.querySelector("p"))},1)})}},{key:"_initEvents",value:function(){var e=this;this.editor.addEventListener("mouseup",this.update.bind(this),!0),this.editor.addEventListener("input",function(){e.$bus.emit("changed")}),window.addEventListener("keyup",this.update.bind(this),!0)}},{key:"clearContent",value:function(){this.sections=[],this.editor.innerHTML=""}},{key:"toggleFullScreen",value:function(){this.el.classList.toggle("is-fullscreen")}},{key:"toggleSidebar",value:function(){this.el.classList.toggle("is-sidebar-active")}},{key:"update",value:function(){var e=this;R.update(),setTimeout(function(){e.settings.toolbar&&e.toolbar.update(),e.settings.bubble&&e.bubble.update(),e.inserter.update()},1)}},{key:"applyFont",value:function(e,t){this.el.style.fontFamily=t.fontName[0]}},{key:"addHTML",value:function(e){var t="";Array.isArray(e)&&(t=e[0]),"string"==typeof e&&(t=e);var n=p(t);if(n){var i=R.range.startContainer;i.parentNode.insertBefore(n,i),this.inserter.hide(),this.update()}}},{key:"addElement",value:function(e){var n=this,t="";Array.isArray(e)&&(t=e[0]),"function"==typeof e&&(t=e),t.add(this).then(function(e){if(e.el){var t=R.range.startContainer;(t=t.closest("p"))&&t.tagName&&("P"===t.tagName&&t.parentNode.replaceChild(e.el,t),"P"!==t.tagName&&t.appendChild(e.el),n.inserter.hide(),n.update())}})}},{key:"content",get:function(){return this.sections.reduce(function(e,t){return"text"!==t.props.type?e:e+=t.content},"")}},{key:"title",get:function(){if(this.postTitle)return this.sections.find(function(e){return"title"===e.props.type}).content}}],[{key:"extend",value:function(e,t){Z[e]=t}},{key:"extendIcons",value:function(e,t){K[e]=t}}]),n}();return we.defaults={toolbar:null,bubble:null,section:null,shortcuts:!1,postTitle:!1},we},"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Align=t();