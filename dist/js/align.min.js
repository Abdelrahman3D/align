!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@baianat/colorpicker")):"function"==typeof define&&define.amd?define(["@baianat/colorpicker"],t):e.Align=t(e.Colorpicker)}(this,function(e){"use strict";function t(e){return"string"==typeof e?document.querySelector(e):e}function n(e,t,n){return Math.round(Math.max(Math.min(Number(e),n),t))}function i(){if("undefined"!=typeof window&&"undefined"!=typeof document){var e=navigator.appVersion;return-1!==e.indexOf("Win")?"Win":-1!==e.indexOf("Mac")?"Mac":-1!==e.indexOf("X11")?"UNIX":-1!==e.indexOf("Linux")?"Linux":"Other"}}function o(e){var t={};return Object.keys(e).forEach(function(n){var i=e[n];t[n]="object"!==(void 0===i?"undefined":y(i))||Array.isArray(i)?i:o(i)}),t}function s(e,t){for(;e!==document&&null!==e;){if(e===t)return!0;e=e.parentNode}return!1}function l(e){return e.charAt(0).toUpperCase()+e.slice(1)}function a(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle-left";if("function"==typeof e.getBoundingClientRect){var s=o.split("-"),l=e.getBoundingClientRect(),a=t.getBoundingClientRect(),r=i.getBoundingClientRect(),c=i.scrollTop,u={x:0,y:0},d=r.width-a.width;return s.forEach(function(e){switch(e){case"center":u.x=l.left-r.left+l.width/2-a.width/2;break;case"left":u.x=l.left-r.left;break;case"right":u.x=l.left-r.left-l.width;break;case"middle":u.y=l.top-r.top+c+l.height/2-a.height/2;break;case"top":u.y=l.top-r.top+c-a.height;break;case"bottom":u.y=l.bottom-r.top+c}}),u.x=n(u.x,0,d),t.style.transform="translate("+u.x+"px, "+u.y+"px)",u}}function r(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function c(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function u(e,t){var n="youtube"===t?/(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/:"vimeo"===t?/vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)/:null;if(n){return e.match(n)[1]}}function d(e){return document.createRange().createContextualFragment(e).firstElementChild}function h(e,t,n){var i=e[t];return e[t]=e[n],e[n]=i,e}function m(e){return'\n    <svg class="align-icon" viewBox="0 0 24 24">\n      <path d="'+E[e]+'"/>\n    </svg>'}function v(e){z=e}function f(e,t){var n=document.createElement("button");return n.classList.add(z+"button"),n.id=e,t&&(n.dataset.tooltip=t),n.insertAdjacentHTML("afterbegin",m(e)),n}function g(e,t){var n=document.createElement("div"),i=document.createElement("select");return n.classList.add(z+"select"),i.id=e,t.forEach(function(t){var n=document.createElement("option");n.value=t,n.innerText=!1===t?e:t,i.appendChild(n)}),n.appendChild(i),n.insertAdjacentHTML("beforeend",'\n    <svg viewBox="0 0 24 24">\n      <polygon points="8,15 12,19 16,15 "/>\n      <polygon points="8,9 12,5 16,9 "/>\n    </svg>'),n}function p(e,t){var n=document.createElement("input");return n.classList.add(""+z+e),n.id=e,n.type=t,n}function H(e,t){var n=document.createElement("div"),i=document.createElement("input");return t&&(n.dataset.tooltip=t),n.classList.add(z+"button"),n.id=e,n.appendChild(i),n.insertAdjacentHTML("afterbegin",m(e)),i.classList.add(z+"input"),i.id=e,i.type="file",{input:i,el:n}}function b(e,t,n){var i=document.createElement("li"),o=f(e,n);return o.addEventListener("click",t),i.appendChild(o),i}function V(e,t,n){var i=document.createElement("div"),o=document.createElement("div"),s=z;z="dropdown-";var l=f(e);z=s;var a=[];return i.classList.add("dropdown"),i.id=e,o.classList.add("dropdown-menu"),t.forEach(function(e){var t=document.createElement("a");t.classList.add("dropdown-item"),t.addEventListener("click",function(){return n(e)}),a.push(t),t.innerHTML=e,o.appendChild(t)}),l.insertAdjacentHTML("beforeend",'\n    <svg viewBox="0 0 24 24" class="dropdown-caret">\n      <polygon points="6,10 12,17 18,10 "/>\n    </svg>'),l.addEventListener("click",function(){return i.classList.toggle("is-active")}),i.appendChild(l),i.appendChild(o),{dropdown:i,items:a}}e=e&&e.hasOwnProperty("default")?e.default:e;var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},M=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),k=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},C=function(){function e(){L(this,e)}return M(e,null,[{key:"selectRange",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.textRange;if(t){var n=e.current;n.removeAllRanges(),n.addRange(t)}}},{key:"selectElement",value:function(t){if(t){var n=document.createRange();n.selectNodeContents(t);var i=e.current;i.removeAllRanges(),i.addRange(n)}}},{key:"clear",value:function(){e.current.empty()}},{key:"update",value:function(){var t=e.current;t.anchorNode&&!t.anchorNode.parentNode.closest(".align-content")||(t.rangeCount&&3===t.anchorNode.nodeType&&(e.textRange=t.getRangeAt(0)),t.rangeCount&&(e.range=t.getRangeAt(0)))}},{key:"current",get:function(){return e._current||window.getSelection()}}]),e}();C._current=null,C.textRange=null,C.range=null;var A=function(){var e=i();return{cmdKey:"Mac"===e?"⌘":"Ctrl",shift:"Mac"===e?"⇧":"Shift",ctrl:"Mac"===e?"⌃":"Ctrl",alt:"Mac"===e?"⌥":"Alt",tab:"Mac"===e?"⇥":"Tab"}}(),w={bold:{element:"button",command:"bold",tooltip:"Bold ("+A.cmdKey+" B)"},italic:{element:"button",command:"italic",tooltip:"Italic ("+A.cmdKey+" I)"},underline:{element:"button",command:"underline",tooltip:"Underline ("+A.cmdKey+" U)"},strikeThrough:{element:"button",command:"strikeThrough",tooltip:"Strike through"},undo:{element:"button",command:"undo",tooltip:"Undo ("+A.cmdKey+" Z)"},redo:{element:"button",command:"redo",tooltip:"Redo ("+A.cmdKey+" "+A.shift+" Z)"},removeFormat:{element:"button",command:"removeFormat",tooltip:"Remove format ("+A.cmdKey+" \\)"},justifyLeft:{element:"button",command:"justifyLeft",tooltip:"Align left ("+A.cmdKey+" L)"},justifyCenter:{element:"button",command:"justifyCenter",tooltip:"Align center ("+A.cmdKey+" E)"},justifyRight:{element:"button",command:"justifyRight",tooltip:"Align right ("+A.cmdKey+" R)"},selectContent:{element:"button",tooltip:"Select all content ("+A.cmdKey+" "+A.shift+" A)",func:function(e){C.selectElement(e.$align.editor)}},justifyFull:{element:"button",command:"justifyFull",tooltip:"Justify full ("+A.cmdKey+" J)"},h1:{element:"button",command:"formatblock",value:"h1",tooltip:"Heading 1"},h2:{element:"button",command:"formatblock",value:"h2",tooltip:"Heading 2"},h3:{element:"button",command:"formatblock",value:"h3",tooltip:"Heading 3"},h4:{element:"button",command:"formatblock",value:"h4",tooltip:"Heading 4"},blockquote:{element:"button",command:"formatblock",value:"blockquote",tooltip:"Quote"},p:{element:"button",command:"formatblock",value:"p",tooltip:"Paragraph"},orderedList:{element:"button",command:"insertOrderedList",tooltip:"Ordered list"},unorderedList:{element:"button",command:"insertUnorderedList",tooltip:"Unordered list"},indent:{element:"button",command:"indent",useCSS:!0,tooltip:"Indent ("+A.tab+")"},outdent:{element:"button",command:"outdent",useCSS:!0,tooltip:"Outdent ("+A.shift+" "+A.tab+")"},superscript:{element:"button",command:"superscript",tooltip:"Superscript ("+A.cmdKey+" "+A.shift+" =)"},subscript:{element:"button",command:"subscript",tooltip:"Subscript ("+A.cmdKey+" =)"},pre:{element:"button",command:"formatblock",value:"pre",func:"highlight",tooltip:"Script"},fontSize:{element:"select",command:"fontSize"},fontName:{element:"select",init:"applyFont",command:"fontName",useCSS:!0},separator:{element:"styling",class:"styler-separator"},fullscreen:{element:"button",func:"toggleFullScreen",tooltip:"Fullscreen ("+A.cmdKey+" "+A.shift+" F)"},color:{element:"input",type:"text",command:"foreColor",tooltip:"Font color",useCSS:!0,init:e,initConfig:{defaultColor:"#fff",mode:"hex",picker:{mode:"square"},guideIcon:'\n        <svg viewBox="0 0 24 24">\n          <path d="M0 20h24v4H0z"/>\n          <path style="fill: currentColor" d="M11 3L5.5 17h2.25l1.12-3h6.25l1.12 3h2.25L13 3h-2zm-1.38 9L12 5.67 14.38 12H9.62z"/>\n        </svg>\n      ',events:{beforeSubmit:function(){C.selectRange()},afterOpen:function(){C.update()},afterSelect:function(){C.update()}}}},backColor:{element:"input",type:"text",command:"backColor",tooltip:"Highlight color",useCSS:!0,init:e,initConfig:{defaultColor:"#fdfdfd",mode:"hex",picker:{mode:"square"},guideIcon:'\n        <svg viewBox="0 0 24 24">\n          <path style="fill: currentColor" d="M16.56 8.94L7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10L10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5z"/>\n          <path d="M0 20h24v4H0z"/>\n        </svg>\n      ',events:{beforeSubmit:function(){C.selectRange()},afterOpen:function(){C.update()},afterSelect:function(){C.update()}}}},createTable:{element:"button",func:"createTable",icon:"table",tooltip:"Add Table"},createFigure:{element:"file",icon:"figure",func:"createFigure",tooltip:"Add Figure"},createPost:{element:"button",icon:"facebook",func:"createPost",tooltip:"Add post"},createEmbed:{element:"button",icon:"embed",func:"createEmbed",tooltip:"Add embed"},createColumn:{element:"button",icon:"column",func:"createColumn",tooltip:"Add columns"},createVideo:{element:"button",icon:"video",func:"createVideo",tooltip:"Add video"},createLine:{element:"dropdown",items:['<hr class="align-line">','<hr class="align-line is-dashed">','<hr class="align-line is-dotted">','<hr class="align-line is-double">','<hr class="align-line is-dots">','<hr class="align-line is-bold">','<hr class="align-line is-bold is-dashed">','<hr class="align-line is-bold is-dotted">','<hr class="align-line is-bold is-double">'],icon:"insertLine",func:"createLine",tooltip:"Add line"},createLink:{element:"button",tooltip:"Hyperlink",func:"createLink"},_figureClasses:{element:"classes",command:"figure"},_sectionClasses:{element:"classes",command:"section"},_sectionToggleHTML:{element:"button",func:"toggleHTML",tooltip:"Edit as HTMl",icon:"toggleHTML"},_remove:{element:"button",func:"remove",tooltip:"Remove section",icon:"remove"},_sectionUp:{element:"button",func:"moveUp",tooltip:"Move section up",icon:"caretUp"},_sectionDown:{element:"button",func:"moveDown",tooltip:"Move section down",icon:"caretDown"},_sectionImage:{element:"file",func:"backgroundImage",tooltip:"Add background image",icon:"image"},_sectionVideo:{element:"file",func:"backgroundVideo",tooltip:"Add background video",icon:"video"},_sectionColor:{element:"input",type:"text",func:"backgroundColor",tooltip:"Change background color",init:e,initConfig:{defaultColor:"#000000",picker:{mode:"square"},mode:"hex",guideIcon:'\n        <svg viewBox="0 0 24 24">\n          <path d="M0 20h24v4H0z"/>\n          <path style="fill: currentColor" d="M17.5,12A1.5,1.5 0 0,1 16,10.5A1.5,1.5 0 0,1 17.5,9A1.5,1.5 0 0,1 19,10.5A1.5,1.5 0 0,1 17.5,12M14.5,8A1.5,1.5 0 0,1 13,6.5A1.5,1.5 0 0,1 14.5,5A1.5,1.5 0 0,1 16,6.5A1.5,1.5 0 0,1 14.5,8M9.5,8A1.5,1.5 0 0,1 8,6.5A1.5,1.5 0 0,1 9.5,5A1.5,1.5 0 0,1 11,6.5A1.5,1.5 0 0,1 9.5,8M6.5,12A1.5,1.5 0 0,1 5,10.5A1.5,1.5 0 0,1 6.5,9A1.5,1.5 0 0,1 8,10.5A1.5,1.5 0 0,1 6.5,12M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A1.5,1.5 0 0,0 13.5,19.5C13.5,19.11 13.35,18.76 13.11,18.5C12.88,18.23 12.73,17.88 12.73,17.5A1.5,1.5 0 0,1 14.23,16H16A5,5 0 0,0 21,11C21,6.58 16.97,3 12,3Z"/>\n        </svg>\n      '}},_tableRowTop:{element:"button",func:"insertRow",args:["before"],icon:"tableRowTop"},_tableRowBottom:{element:"button",func:"insertRow",args:["after"],icon:"tableRowBottom"},_tableColumnBefore:{element:"button",func:"insertColumn",args:["before"],icon:"tableColumnBefore"},_tableColumnAfter:{element:"button",func:"insertColumn",args:["after"],icon:"tableColumnAfter"},_tableDeleteRow:{element:"button",func:"deleteRow",icon:"tableDeleteRow"},_tableDeleteColumn:{element:"button",func:"deleteColumn",icon:"tableDeleteColumn"}},E={blockquote:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z",bold:"M13.5,15.5H10V12.5H13.5A1.5,1.5 0 0,1 15,14A1.5,1.5 0 0,1 13.5,15.5M10,6.5H13A1.5,1.5 0 0,1 14.5,8A1.5,1.5 0 0,1 13,9.5H10M15.6,10.79C16.57,10.11 17.25,9 17.25,8C17.25,5.74 15.5,4 13.25,4H7V18H14.04C16.14,18 17.75,16.3 17.75,14.21C17.75,12.69 16.89,11.39 15.6,10.79Z",fontSize:"M9 4v3h5v12h3V7h5V4H9zm-6 8h3v7h3v-7h3V9H3v3z",h1:"M3,4H5V10H9V4H11V18H9V12H5V18H3V4M14,18V16H16V6.31L13.5,7.75V5.44L16,4H18V16H20V18H14Z",h2:"M3,4H5V10H9V4H11V18H9V12H5V18H3V4M21,18H15A2,2 0 0,1 13,16C13,15.47 13.2,15 13.54,14.64L18.41,9.41C18.78,9.05 19,8.55 19,8A2,2 0 0,0 17,6A2,2 0 0,0 15,8H13A4,4 0 0,1 17,4A4,4 0 0,1 21,8C21,9.1 20.55,10.1 19.83,10.83L15,16H21V18Z",h3:"M3,4H5V10H9V4H11V18H9V12H5V18H3V4M15,4H19A2,2 0 0,1 21,6V16A2,2 0 0,1 19,18H15A2,2 0 0,1 13,16V15H15V16H19V12H15V10H19V6H15V7H13V6A2,2 0 0,1 15,4Z",h4:"M3,4H5V10H9V4H11V18H9V12H5V18H3V4M18,18V13H13V11L18,4H20V11H21V13H20V18H18M18,11V7.42L15.45,11H18Z",html:"M19 12h-2v3h-3v2h5v-5zM7 9h3V7H5v5h2V9zm14-6H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16.01H3V4.99h18v14.02z",italic:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z",justifyCenter:"M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z",justifyFull:"M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zm0-6v2h18V3H3z",justifyLeft:"M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z",justifyRight:"M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z",p:"M13,4A4,4 0 0,1 17,8A4,4 0 0,1 13,12H11V18H9V4H13M13,10A2,2 0 0,0 15,8A2,2 0 0,0 13,6H11V10H13Z",pre:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z",removeFormat:"M15 16h4v2h-4zm0-8h7v2h-7zm0 4h6v2h-6zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3v10zM14 5h-3l-1-1H6L5 5H2v2h12z",strikeThrough:"M23,12V14H18.61C19.61,16.14 19.56,22 12.38,22C4.05,22.05 4.37,15.5 4.37,15.5L8.34,15.55C8.37,18.92 11.5,18.92 12.12,18.88C12.76,18.83 15.15,18.84 15.34,16.5C15.42,15.41 14.32,14.58 13.12,14H1V12H23M19.41,7.89L15.43,7.86C15.43,7.86 15.6,5.09 12.15,5.08C8.7,5.06 9,7.28 9,7.56C9.04,7.84 9.34,9.22 12,9.88H5.71C5.71,9.88 2.22,3.15 10.74,2C19.45,0.8 19.43,7.91 19.41,7.89Z",text:"M5 17v2h14v-2H5zm4.5-4.2h5l.9 2.2h2.1L12.75 4h-1.5L6.5 15h2.1l.9-2.2zM12 5.98L13.87 11h-3.74L12 5.98z",underline:"M5,21H19V19H5V21M12,17A6,6 0 0,0 18,11V3H15.5V11A3.5,3.5 0 0,1 12,14.5A3.5,3.5 0 0,1 8.5,11V3H6V11A6,6 0 0,0 12,17Z",unorderedList:"M7,5H21V7H7V5M7,13V11H21V13H7M4,4.5A1.5,1.5 0 0,1 5.5,6A1.5,1.5 0 0,1 4,7.5A1.5,1.5 0 0,1 2.5,6A1.5,1.5 0 0,1 4,4.5M4,10.5A1.5,1.5 0 0,1 5.5,12A1.5,1.5 0 0,1 4,13.5A1.5,1.5 0 0,1 2.5,12A1.5,1.5 0 0,1 4,10.5M7,19V17H21V19H7M4,16.5A1.5,1.5 0 0,1 5.5,18A1.5,1.5 0 0,1 4,19.5A1.5,1.5 0 0,1 2.5,18A1.5,1.5 0 0,1 4,16.5Z",orderedList:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z",indent:"M3 21h18v-2H3v2zM3 8v8l4-4-4-4zm8 9h10v-2H11v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z",outdent:"M11 17h10v-2H11v2zm-8-5l4 4V8l-4 4zm0 9h18v-2H3v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z",superscript:"M16 18.6L14.6 20 9 14.4 3.4 20 2 18.6 7.6 13 2 7.4 3.4 6 9 11.6 14.6 6 16 7.4 10.4 13l5.6 5.6zm2.3-14.2c0-.2.1-.4.1-.6.1-.2.2-.3.3-.4.1-.1.3-.2.4-.3.2-.1.4-.1.5-.1.2 0 .3 0 .4.1.1.1.3.1.3.2.1.1.2.2.2.4.1.1.1.3.1.5s-.1.4-.2.6c-.1.2-.2.3-.4.5-.2.1-.4.3-.6.4-.2.1-.5.3-.7.4-.2.1-.5.3-.7.4s-.2.3-.4.5-.3.3-.4.5c-.1.2-.2.4-.2.7V9h5V8h-3.8c.1-.2.3-.4.5-.6.3-.2.6-.4.8-.6s.6-.4.9-.5c.3-.2.6-.4.8-.6s.4-.5.6-.7c.1-.3.2-.6.2-.9 0-.3 0-.5-.1-.8s-.2-.5-.4-.7c-.2-.2-.4-.3-.7-.5-.4 0-.7-.1-1.2-.1-.4 0-.7.1-1 .2s-.6.3-.8.5c-.2.2-.4.5-.5.8-.2.2-.3.5-.3.9h1.3z",subscript:"M16 16.6L14.6 18 9 12.4 3.4 18 2 16.6 7.6 11 2 5.4 3.4 4 9 9.6 14.6 4 16 5.4 10.4 11l5.6 5.6zm2.3.8c0-.2.1-.4.1-.6.1-.2.2-.3.3-.4.1-.1.3-.2.4-.3s.3-.1.5-.1.3 0 .4.1c.1.1.3.1.3.2.1.1.2.2.2.4s.1.3.1.5-.1.4-.2.6c-.1.2-.2.3-.4.5-.2.1-.4.3-.6.4-.2.1-.5.3-.7.4-.2.1-.5.3-.7.4s-.4.3-.6.5c-.2.2-.3.3-.4.5-.1.2-.2.4-.2.6v.9h5v-1H18c.1-.2.3-.4.5-.6.2-.2.5-.4.8-.5s.6-.4.9-.5c.3-.2.6-.4.8-.6s.4-.5.6-.7c.2-.3.2-.6.2-.9 0-.3 0-.5-.1-.8s-.2-.5-.4-.7c-.2-.2-.4-.3-.7-.5-.3-.1-.7-.2-1.1-.2-.4 0-.7.1-1 .2-.3.1-.6.3-.8.5-.2.2-.4.5-.5.8-.1.3-.2.6-.3 1h1.4z",createLink:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z",selectContent:"M9,9H15V15H9M7,17H17V7H7M15,5H17V3H15M15,21H17V19H15M19,17H21V15H19M19,9H21V7H19M19,21A2,2 0 0,0 21,19H19M19,13H21V11H19M11,21H13V19H11M9,3H7V5H9M3,17H5V15H3M5,21V19H3A2,2 0 0,0 5,21M19,3V5H21A2,2 0 0,0 19,3M13,3H11V5H13M3,9H5V7H3M7,21H9V19H7M3,13H5V11H3M3,5H5V3A2,2 0 0,0 3,5Z",insertLine:"M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3 3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z",undo:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z",redo:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z",plus:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z",video:"M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z",image:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z",figure:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z",figureFloatRight:"M15,7H21V13H15V7M3,3H21V5H3V3M13,7V9H3V7H13M9,11V13H3V11H9M3,15H17V17H3V15M3,19H21V21H3V19Z",figureCenter:"M9,7H15V13H9V7M3,3H21V5H3V3M3,15H21V17H3V15M3,19H17V21H3V19Z",figureFloatLeft:"M3,7H9V13H3V7M3,3H21V5H3V3M21,7V9H11V7H21M21,11V13H11V11H21M3,15H17V17H3V15M3,19H21V21H3V19Z",figureFull:"M23 18V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zM8.5 12.5l2.5 3.01L14.5 11l4.5 6H5l3.5-4.5z",table:"M5,4H19A2,2 0 0,1 21,6V18A2,2 0 0,1 19,20H5A2,2 0 0,1 3,18V6A2,2 0 0,1 5,4M5,8V12H11V8H5M13,8V12H19V8H13M5,14V18H11V14H5M13,14V18H19V14H13Z",sectionNormal:"M12.5,19.5V3.47H14.53V19.5H12.5M9.5,19.5V3.47H11.53V19.5H9.5M4.5,7.5L8.53,11.5L4.5,15.47V12.47H1.5V10.5H4.5V7.5M19.5,15.47L15.5,11.5L19.5,7.5V10.5H22.5V12.47H19.5V15.47Z",sectionFull:"M9,11H15V8L19,12L15,16V13H9V16L5,12L9,8V11M2,20V4H4V20H2M20,20V4H22V20H20Z",section:"M2 21h19v-3H2v3zM20 8H3c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h17c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zM2 3v3h19V3H2z",fullscreen:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z",column:"M16,5V18H21V5M4,18H9V5H4M10,18H15V5H10V18Z",delete:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z",facebook:"M5,3H19A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3M18,5H15.5A3.5,3.5 0 0,0 12,8.5V11H10V14H12V21H15V14H18V11H15V9A1,1 0 0,1 16,8H18V5Z",twitter:'"M5,3H19A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3M17.71,9.33C18.19,8.93 18.75,8.45 19,7.92C18.59,8.13 18.1,8.26 17.56,8.33C18.06,7.97 18.47,7.5 18.68,6.86C18.16,7.14 17.63,7.38 16.97,7.5C15.42,5.63 11.71,7.15 12.37,9.95C9.76,9.79 8.17,8.61 6.85,7.16C6.1,8.38 6.75,10.23 7.64,10.74C7.18,10.71 6.83,10.57 6.5,10.41C6.54,11.95 7.39,12.69 8.58,13.09C8.22,13.16 7.82,13.18 7.44,13.12C7.81,14.19 8.58,14.86 9.9,15C9,15.76 7.34,16.29 6,16.08C7.15,16.81 8.46,17.39 10.28,17.31C14.69,17.11 17.64,13.95 17.71,9.33Z',embed:"M12.89,3L14.85,3.4L11.11,21L9.15,20.6L12.89,3M19.59,12L16,8.41V5.58L22.42,12L16,18.41V15.58L19.59,12M1.58,12L8,5.58V8.41L4.41,12L8,15.58V18.41L1.58,12",tableRowTop:"M22,14A2,2 0 0,0 20,12H4A2,2 0 0,0 2,14V21H4V19H8V21H10V19H14V21H16V19H20V21H22V14M4,14H8V17H4V14M10,14H14V17H10V14M20,14V17H16V14H20M11,10H13V7H16V5H13V2H11V5H8V7H11V10Z",tableRowBottom:"M22,10A2,2 0 0,1 20,12H4A2,2 0 0,1 2,10V3H4V5H8V3H10V5H14V3H16V5H20V3H22V10M4,10H8V7H4V10M10,10H14V7H10V10M20,10V7H16V10H20M11,14H13V17H16V19H13V22H11V19H8V17H11V14Z",tableColumnBefore:"M13,2A2,2 0 0,0 11,4V20A2,2 0 0,0 13,22H22V2H13M20,10V14H13V10H20M20,16V20H13V16H20M20,4V8H13V4H20M9,11H6V8H4V11H1V13H4V16H6V13H9V11Z",tableColumnAfter:"M11,2A2,2 0 0,1 13,4V20A2,2 0 0,1 11,22H2V2H11M4,10V14H11V10H4M4,16V20H11V16H4M4,4V8H11V4H4M15,11H18V8H20V11H23V13H20V16H18V13H15V11Z",tableDeleteColumn:"M4,2H11A2,2 0 0,1 13,4V20A2,2 0 0,1 11,22H4A2,2 0 0,1 2,20V4A2,2 0 0,1 4,2M4,10V14H11V10H4M4,16V20H11V16H4M4,4V8H11V4H4M17.59,12L15,9.41L16.41,8L19,10.59L21.59,8L23,9.41L20.41,12L23,14.59L21.59,16L19,13.41L16.41,16L15,14.59L17.59,12Z",tableDeleteRow:"M9.41,13L12,15.59L14.59,13L16,14.41L13.41,17L16,19.59L14.59,21L12,18.41L9.41,21L8,19.59L10.59,17L8,14.41L9.41,13M22,9A2,2 0 0,1 20,11H4A2,2 0 0,1 2,9V6A2,2 0 0,1 4,4H20A2,2 0 0,1 22,6V9M4,9H8V6H4V9M10,9H14V6H10V9M16,9H20V6H16V9Z",remove:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z",caretUp:"M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z",caretDown:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z",toggleHTML:"M14.6,16.6L19.2,12L14.6,7.4L16,6L22,12L16,18L14.6,16.6M9.4,16.6L4.8,12L9.4,7.4L8,6L2,12L8,18L9.4,16.6Z"},z="",T=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.mode,o=void 0===i?"toolbar":i,s=n.commands,l=void 0===s?["bold","italic","underline"]:s,a=n.hideWhenClickOut,r=void 0!==a&&a,c=n.tooltip,u=void 0!==c&&c,d=n.theme,h=void 0===d?"light":d,m=n.position,v=void 0===m?"center-top":m;L(this,e),this.$align=t,this.settings={mode:o,commands:l,hideWhenClickOut:r,tooltip:u,theme:h,position:v},this._init()}return M(e,[{key:"_init",value:function(){var e=this;v("styler-"),this.cmdsSchema=o(w),this.el=document.createElement("div"),this.menu=document.createElement("ul"),this.el.classList.add("styler","is-"+this.settings.mode,"is-"+this.settings.theme),this.el.appendChild(this.menu),this.menu.classList.add("styler-menu"),this.cmds={},this.visible=!1,this.settings.commands.forEach(function(t){e.generateCmdElement(t)}),this.$align.el.appendChild(this.el),"bubble"===this.settings.mode&&this._initBubble(),"creator"===this.settings.mode&&this._initCreator(),this.settings.hideWhenClickOut&&(this.clickCallback=function(t){s(t.target,e.el)||s(t.target,e.currentItem.el)||e.hide()})}},{key:"_initBubble",value:function(){var e=this;this.el.classList.add("is-hidden"),this.currentPosition=null;var t=!1;this.bubbleScrollCallback=function(){e.scrollY=window.scrollY,t||(window.requestAnimationFrame(function(){e.currentPosition||e.updateBubble(),t=!1}),t=!0)}}},{key:"_initCreator",value:function(){var e=this;this.toggleButton=f("plus"),this.toggleButton.addEventListener("click",function(){e.el.classList.toggle("is-active")}),this.el.insertBefore(this.toggleButton,this.menu),this.hide()}},{key:"generateCmdElement",value:function(e){var t=this,n=document.createElement("li"),i="string"==typeof e?e:Object.keys(e)[0],o=this.cmdsSchema[i];if(!o)return void console.warn(i+" is not found");var s=this.cmds[i]={schema:o},a=o.icon||i;switch(o.element){case"button":s.el=f(a,this.getTooltip(o)),s.el.addEventListener("click",function(){return t.cmdCallback(o,o.value)}),n.appendChild(s.el);break;case"file":var r=H(a,this.getTooltip(o));s.el=r.input,s.el.addEventListener("change",function(e){t.cmdCallback(o,e)}),n.appendChild(r.el);break;case"input":s.el=p(a,o.type,this.getTooltip(o)),s.el.addEventListener("change",function(){t.cmdCallback(o,s.el.value)}),n.appendChild(s.el);break;case"select":var c=g(a,e[i]),u=s.el=c.querySelector("select");u.addEventListener("change",function(){return t.cmdCallback(o,u[u.selectedIndex].value)}),n.appendChild(c);break;case"dropdown":var d=V(a,o.items,function(e){return t.cmdCallback(o,e)});n.appendChild(d.dropdown);break;case"styling":n.classList.add(o.class);break;case"custom":var h=o.create(this);n.appendChild(h);break;case"classes":s.el=document.createElement("ul"),e[i].forEach(function(n){var a=b(""+o.command+l(n),function(){t.toggleClass("is-"+n,e[i])},l(o.command)+" "+n);s.el.appendChild(a)}),n.appendChild(s.el);break;default:console.warn(i+" element not found")}"function"==typeof o.init&&(o.init=new o.init(s.el,o.initConfig)),"string"==typeof o.init&&(this.$align[o.init](o,e),o.init=null),this.menu.appendChild(n)}},{key:"cmdCallback",value:function(e,t){if(e.command&&this.execute(e.command,t,e.useCSS),"string"==typeof e.func){(this.$align[e.func]?this.$align[e.func].bind(this.$align):this.currentItem[e.func].bind(this.currentItem))(this,t||e)}"function"==typeof e.func&&e.func(this,t||e),this.update()}},{key:"execute",value:function(e,t){var n;(n=this.$align).execute.apply(n,arguments)}},{key:"updateBubble",value:function(e){if(C.range&&!C.range.collapsed&&C.range===C.current.getRangeAt(0)||this.currentItem){var t=this.currentItem?this.currentItem.el:C.range;return this.currentPosition=a(t,this.el,this.$align.el,e||this.settings.position),void this.show()}this.hide()}},{key:"updateCreator",value:function(e){if(C.range&&C.range.collapsed&&1===C.range.startContainer.nodeType&&C.range.startContainer.childNodes.length<=1)return this.position=a(C.range.startContainer,this.el,this.$align.el,e||this.settings.position),void this.show();this.hide()}},{key:"show",value:function(){var e=this;this.visible||(this.visible=!0,this.updateTemp=null,this.el.style.transition="opacity 0.2s",this.el.classList.add("is-visible"),this.el.classList.remove("is-hidden"),setTimeout(function(){e.el.style.transition=""},200),this.settings.hideWhenClickOut&&document.addEventListener("click",this.clickCallback))}},{key:"hide",value:function(){this.currentItem&&(this.currentItem.el.classList.remove("is-active"),this.currentItem=null),this.el.classList.remove("is-visible"),this.el.classList.remove("is-active"),this.el.classList.add("is-hidden"),this.visible=!1,this.settings.hideWhenClickOut&&document.removeEventListener("click",this.clickCallback)}},{key:"update",value:function(e){this.currentItem&&this.currentItem.el.classList.remove("is-active"),e&&(this.currentItem=e,this.currentItem.el.classList.add("is-active")),this.updateCommandsStates(),"bubble"===this.settings.mode&&this.updateBubble(),"creator"===this.settings.mode&&this.updateCreator()}},{key:"getTooltip",value:function(e){return!(!e.tooltip||!this.settings.tooltip)&&(this.$align.settings.shortcuts?e.tooltip:e.tooltip.replace(/(\([^)]+\))/g,""))}},{key:"updateCommandsStates",value:function(){Object.values(this.cmds).forEach(function(e){var t=e,n=t.schema.command,i=t.schema.value,o=t.schema.init;if(n){if(document.queryCommandState(n))return void t.el.classList.add("is-active");if(document.queryCommandValue(n)===i)return void t.el.classList.add("is-active");if(o){return void((1===C.current.anchorNode.type?C.current.anchorNode:C.current.anchorNode.parentNode).closest(".align-content")&&(document.queryCommandValue(n),o.selectColor(document.queryCommandValue(n),!0)))}document.queryCommandValue(n)&&(t.el.value=document.queryCommandValue(n)),t.el.classList.remove("is-active")}})}},{key:"toggleClass",value:function(e,t){var n,i=this;if(this.currentItem){var o=t.map(function(e){return"is-"+e});(n=this.currentItem.el.classList).remove.apply(n,k(o)),this.currentItem.el.classList.toggle(e),this.update();var s=function e(){i.update(),i.currentItem.el.removeEventListener("transitionend",e)};this.currentItem.el.addEventListener("transitionend",s)}}}]),e}(),S=function(){function e(t,n){if(L(this,e),!n)return{el:null};this.$align=t,this._init(n)}return M(e,[{key:"_init",value:function(e){var t=this;1===e.nodeType&&(this.el=e,this.caption=e.querySelector("figcaption"),this.img=e.querySelector("img")),1!==e.nodeType&&(this.el=document.createElement("figure"),this.caption=document.createElement("figcaption"),this.img=document.createElement("img"),this.readFileContent(e)),this.el.contentEditable=!1,this.caption.contentEditable=!0,this.caption.dataset.defaultValue="Figure caption",this.img.classList.add("align-image"),this.el.classList.add("align-figure","is-center"),this.el.appendChild(this.img),this.el.appendChild(this.caption),this.el.addEventListener("click",function(){t.$align.$figureToolbar.update(t)})}},{key:"readFileContent",value:function(e){var t=this;if(!this.isImage(e.name))return{el:null};var n=new FileReader;n.addEventListener("load",function(){t.img.src=n.result,t.img.dataset.alignFilename=e.name,t.$align.$bus.emit("imageAdded",{file:e,update:t.update.bind(t)})}),n.readAsDataURL(e)}},{key:"isImage",value:function(e){switch(e.split(".").slice(-1)[0].toLowerCase()){case"jpg":case"jpge":case"gif":case"bmp":case"png":return!0}return!1}},{key:"update",value:function(e){this.img.src=e}},{key:"remove",value:function(){this.$align.$figureToolbar.hide(),this.el.remove()}}],[{key:"config",value:function(e){e.$figureToolbar=new T(e,Object.assign({mode:"bubble",hideWhenClickOut:!0,commands:[{_figureClasses:["floatLeft","center","floatRight","full"]},"_remove"],tooltip:!0},e.settings.figure))}}]),e}(),x=function(){function e(t,n){L(this,e),n&&(this.$align=t,this._init(n),this._initEvents(),this.activeCell=this.el.rows[0].cells[0])}return M(e,[{key:"_init",value:function(e){if("TABLE"===e.nodeName)return this.el=e,void this.el.classList.add("align-table");var t=Number(e.rows),n=Number(e.columns);isNaN(t)||isNaN(n)||(this.el=document.createElement("table"),this.el.classList.add("align-table"),this.el.insertAdjacentHTML("afterbegin",("\n        <tr>\n          "+"<td><br></td>".repeat(n)+"\n        </tr>\n      ").repeat(t)))}},{key:"_initEvents",value:function(){var e=this;this.el.addEventListener("click",function(t){e.activeCell=t.target,e.$align.$tableToolbar.update(e)})}},{key:"insertRow",value:function(e,t){for(var n=t.args[0],i=this.el.rows[0].cells.length,o=this.activeCell.parentNode.rowIndex+("after"===n?1:0),s=this.el.insertRow(o),l=0;l<i;l++){s.insertCell(l).insertAdjacentHTML("afterbegin","<br>")}}},{key:"deleteRow",value:function(){this.el.deleteRow(this.activeCell.parentNode.rowIndex)}},{key:"insertColumn",value:function(e,t){for(var n=t.args[0],i=this.el.rows.length,o=this.activeCell.cellIndex+("after"===n?1:0),s=0;s<i;s++){this.el.rows[s].insertCell(o).insertAdjacentHTML("afterbegin","<br>")}}},{key:"deleteColumn",value:function(){for(var e=this.el.rows.length,t=this.activeCell.cellIndex,n=0;n<e;n++)this.el.rows[n].deleteCell(t)}},{key:"remove",value:function(){this.$align.$tableToolbar.hide(),this.el.remove()}}],[{key:"config",value:function(e){e.$tableToolbar=new T(e,Object.assign({mode:"bubble",hideWhenClickOut:!0,commands:["_tableRowTop","_tableRowBottom","_tableColumnBefore","_tableColumnAfter","separator","_tableDeleteRow","_tableDeleteColumn","separator","_remove"],tooltip:!0},e.settings.table))}}]),e}(),R=function(){function e(t){
var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.message,o=void 0===i?"":i,s=n.data,l=void 0===s?"":s,a=n.position,r=void 0===a?null:a,c=n.inputsCount,u=void 0===c?1:c,d=n.inputsPlaceholders,h=void 0===d?[]:d;L(this,e),this.settings={position:r,inputsCount:u,inputsPlaceholders:h},this.$align=t,this._init(o,l)}return M(e,[{key:"_init",value:function(e,t){var n=this,i=this.settings.position;this.el=document.createElement("div"),this.message=document.createElement("label"),this.inputs=[],this.el.classList.add("prompt"),this.message.classList.add("prompt-message"),i&&(this.el.style.left=i.left+"px",this.el.style.top=i.top+"px"),i||(3===C.range.startContainer.nodeType&&(this.selectionReference=C.range),1===C.range.startContainer.nodeType&&(this.selectionReference=C.range.startContainer),setTimeout(function(){a(n.selectionReference,n.el,n.$align.el,"left-top")},1)),this.message.innerText=e,this.el.appendChild(this.message);for(var o=0;o<this.settings.inputsCount;o++)this.inputs[o]=document.createElement("input"),this.inputs[o].classList.add("prompt-input"),this.settings.inputsPlaceholders[o]&&(this.inputs[o].placeholder=this.settings.inputsPlaceholders[o]),this.el.appendChild(this.inputs[o]);this.inputs[0].value=t,this.$align.el.appendChild(this.el),setTimeout(function(){document.addEventListener("click",function(e){s(e.target,n.el)||n.remove()})},1)}},{key:"_generateButton",value:function(e){this[e]=document.createElement("button"),this[e].classList.add("prompt-button"),this[e].innerText=e,this[e].addEventListener("click",this.remove.bind(this)),this.el.appendChild(this[e])}},{key:"onSubmit",value:function(e,t){return this._generateButton("submit"),this.submit.addEventListener("click",function(){return e(t)}),this}},{key:"onDelete",value:function(e,t){return this._generateButton("delete"),this.delete.addEventListener("click",function(){return e(t)}),this}},{key:"onCancel",value:function(e,t){return this._generateButton("cancel"),this.cancel.addEventListener("click",function(){return e(t)}),this}},{key:"remove",value:function(){var e=this;setTimeout(function(){e.el.remove()},1)}}]),e}(),$=function(){function e(t,n){L(this,e),this.$align=t,this._init(n)}return M(e,[{key:"_init",value:function(e){this.el=e||document.createElement("a"),e||(this.el.appendChild(C.range.extractContents()),C.range.insertNode(this.el)),this.el.addEventListener("click",this.edit.bind(this))}},{key:"edit",value:function(){var e=this,t=new R(this.$align,{message:"Enter link:",data:this.el.href});t.onSubmit(function(){var n=t.inputs[0].value;n&&e.update(n)}),this.el.href&&t.onDelete(function(){e.remove()})}},{key:"update",value:function(e){this.el.href=e}},{key:"remove",value:function(){var e=this.el.innerHTML;this.el.insertAdjacentHTML("beforebegin",e),this.el.remove()}}]),e}(),_=function(){function e(t,n){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=o.position,l=o.type,a=void 0===l?"text":l;if(L(this,e),!n||"BR"!==n.nodeName){if(this.id=e.id++,this.type=a,this.isHTMLView=!1,this.$align=t,this.generateEl(n),"text"===a&&this.el.addEventListener("click",function(){i.$align.$sectionToolbar.update(i)}),"object"===(void 0===s?"undefined":y(s)))return void this.$align.editor.insertBefore(this.el,s);this.$align.editor.appendChild(this.el),this.$align.sections.push(this)}}return M(e,[{key:"generateEl",value:function(e){var t=this;switch(this.el=e&&"DIV"===e.nodeName?e:document.createElement("div"),this.el.classList.add("align-section"),this.type){case"text":this.contentDiv=this.el.querySelector(".align-content")||document.createElement("div"),this.contentDiv.classList.add("align-content"),this.contentDiv.contentEditable=!0,e=e?this.contentDiv.innerHTML||this.el.innerHTML||e.outerHTML:"<p></p>",this.contentDiv.querySelector("pre[data-align-html]")&&(e=this.contentDiv.innerText),this.el.innerHTML="",this.el.appendChild(this.contentDiv),this.contentDiv.innerHTML=e,this.bgImage=this.bgImage||this.contentDiv.querySelector(".align-bgImage"),this.bgVideo=this.bgVideo||this.contentDiv.querySelector(".align-bgVideo"),this.generateSectionElements();break;case"title":this.title=this.el.querySelector(".align-title")||document.createElement("h1"),this.title.classList.add("align-title"),this.title.contentEditable=!0,this.title.innerText=e,this.el.appendChild(this.title),this.title.addEventListener("blur",function(){t.title.innerHTML=t.title.innerText})}}},{key:"generateSectionElements",value:function(){var e=this,t=Array.from(this.contentDiv.querySelectorAll("figure")),n=Array.from(this.contentDiv.querySelectorAll("table")),i=Array.from(this.contentDiv.querySelectorAll("a"));t.forEach(function(t){return new S(e.$align,t)}),n.forEach(function(t){return new x(e.$align,t)}),i.forEach(function(t){return new $(e.$align,t)}),this.generateAddSectionButton(),this.generateBackground()}},{key:"generateAddSectionButton",value:function(){var t=this;this.addSectionButton=document.createElement("button"),this.addSectionButton.classList.add("align-newSection"),this.addSectionButton.addEventListener("click",function(){return new e(t.$align,"",{position:t.el})}),this.addSectionButton.contentEditable=!1,this.el.insertAdjacentElement("afterBegin",this.addSectionButton)}},{key:"generateBackground",value:function(){this.bgImage&&this.el.insertAdjacentElement("afterBegin",this.bgImage),this.bgVideo&&this.el.insertAdjacentElement("afterBegin",this.bgVideo)}},{key:"getIndex",value:function(){var e=this;return this.$align.sections.findIndex(function(t){return t===e})}},{key:"toggleHTML",value:function(){if(!this.isHTMLView){this.isHTMLView=!0;var e=document.createTextNode(this.contentDiv.innerHTML),t=document.createElement("pre");return this.contentDiv.innerHTML="",t.dataset.alignHtml=!0,t.appendChild(e),this.contentDiv.appendChild(t),void this.$align.highlight()}this.generateEl(this.el),this.contentDiv.focus(),this.isHTMLView=!1}},{key:"backgroundColor",value:function(e,t){this.el.style.backgroundColor=t}},{key:"backgroundImage",value:function(e,t){var n=this,i=t.target,o=i.files[0];if(o){this.bgImage||(this.bgImage=document.createElement("div"),this.bgImage.classList.add("align-bgImage"),this.el.insertAdjacentElement("afterBegin",this.bgImage));var s=function(e){n.bgImage.style.backgroundImage="url("+e+")"};this.bgImage.style.backgroundImage="url("+URL.createObjectURL(o)+")",this.el.classList.add("is-bgImage"),this.$align.update(),this.$align.$bus.emit("imageAdded",{file:o,update:s}),i.value=null}}},{key:"backgroundVideo",value:function(e,t){var n=t.target,i=n.files[0];if(i){var o=window.URL.createObjectURL(t.target.files[0]),s=null;this.bgVideo||(this.bgVideo=d('<video autoplay muted loop class="align-bgVideo"></video>'),s=document.createElement("source"),this.bgVideo.appendChild(s),this.el.insertAdjacentElement("afterBegin",this.bgVideo)),this.bgVideo&&(s=this.bgVideo.querySelector("source")),this.el.classList.add("is-bgVideo"),s.src=o;var l=function(e){s.src=e};this.$align.update(),this.$align.$bus.emit("videoAdded",{file:i,update:l}),n.value=null}}},{key:"moveUp",value:function(){var e=this.getIndex();this.$align.sections[e-1]&&"title"!==this.$align.sections[e-1].type&&(this.$align.editor.insertBefore(this.el,this.$align.sections[e-1].el),h(this.$align.sections,e,e-1))}},{key:"moveDown",value:function(){var e=this.getIndex();this.$align.sections[e+1]&&(this.$align.editor.insertBefore(this.el,this.$align.sections[e+1].el.nextSibling),h(this.$align.sections,e,e+1))}},{key:"active",value:function(){this.$align.$sectionToolbar.update(this),this.el.focus()}},{key:"remove",value:function(){this.$align.$sectionToolbar.hide(),this.el.remove(),this.$align.sections.splice(this.getIndex(),1)}},{key:"content",get:function(){var e=void 0;if("text"===this.type){e=this.el.cloneNode(!0);var t=e.querySelector(".align-newSection"),n=e.querySelector(".align-content");this.isHTMLView&&(n.innerHTML=n.innerText),e.classList.remove("is-active"),e.insertAdjacentHTML("beforeend",n.innerHTML),n.remove(),t.remove()}return"title"===this.type?this.title.innerText:e.outerHTML}}],[{key:"config",value:function(e){e.$sectionToolbar=new T(e,Object.assign({mode:"bubble",hideWhenClickOut:!0,commands:["_sectionUp","_sectionDown","_sectionColor","_sectionImage","_sectionVideo","_sectionToggleHTML",{_sectionClasses:["normal","full"]},"_remove"],tooltip:!0,position:"left-top"},e.settings.section))}}]),e}();_.id=0;var I=function(){function e(){L(this,e),this.events={}}return M(e,[{key:"on",value:function(e,t){var n=this;this.events[e]||(this.events[e]=[]);var i=this.events[e].length;return this.events[e].push(t),function(){n.events[e].splice(i,1)}}},{key:"once",value:function(e,t){var n=this,i=this.events.eventName?this.events[e].length:0,o=function(){t.apply(void 0,arguments),n.events[e].splice(i,1)};this.on(e,o)}},{key:"emit",value:function(e,t){var n=this;this.events[e]&&this.events[e].length&&setTimeout(function(){n.events[e].forEach(function(e){return e(t)})},0)}}]),e}();return function(){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.toolbar,s=void 0===o?null:o,l=i.bubble,a=void 0===l?null:l,r=i.creator,c=void 0===r?null:r,u=i.section,d=void 0===u?null:u,h=i.shortcuts,m=void 0!==h&&h,v=i.postTitle,f=void 0!==v&&v;L(this,e),this.el=t(n),this.settings={toolbar:s,bubble:a,creator:c,section:d,shortcuts:m,postTitle:f},this._init()}return M(e,[{key:"_init",value:function(){this.$bus=new I,this.startContent=Array.from(this.el.children),this.el.innerText="",_.config(this),S.config(this),x.config(this),this.settings.toolbar&&(this.settings.toolbar.mode="toolbar",this.toolbar=new T(this,this.settings.toolbar)),this.settings.bubble&&(this.settings.bubble.mode="bubble",this.settings.bubble.tooltip=!1,this.bubble=new T(this,this.settings.bubble)),this.settings.creator&&(this.settings.creator.mode="creator",this.settings.creator.position="middle-left",this.creator=new T(this,this.settings.creator)),this._initEditor(),this._initSections(),this._initEvents()}},{key:"_initEditor",value:function(){document.execCommand("defaultParagraphSeparator",!1,"p"),this.editor=document.createElement("div"),this.editor.classList.add("align-editor"),this.cmdKey="Mac"===i()?"metaKey":"ctrlKey",this.cmdKeyPressed=!1,this.el.appendChild(this.editor),this.editor.focus(),C.update()}},{key:"_initSections",value:function(){var e=this;this.sections=[],!1!==this.settings.postTitle&&(this.postTitle=new _(this,this.settings.postTitle,{type:"title"})),this.startContent.forEach(function(t){return new _(e,t)}),this.newSectionButton=document.createElement("button"),this.newSectionButton.classList.add("align-addButton"),this.el.appendChild(this.newSectionButton),this.newSectionButton.addEventListener("click",function(){var t=new _(e);t.active(),C.selectElement(t.contentDiv.querySelector("p")),e.update()})}},{key:"_initEvents",value:function(){var e=this;this.editor.addEventListener("focus",function(){e.highlight()}),this.editor.addEventListener("mouseup",this.update.bind(this),!0),window.addEventListener("keydown",function(t){if(!t.defaultPrevented){if(t[e.cmdKey]&&e.settings.shortcuts)switch(t.key.toUpperCase()){case"B":t.preventDefault(),e.execute("bold");break;case"I":t.preventDefault(),e.execute("italic");break;case"U":t.preventDefault(),e.execute("underline");break;case"E":t.preventDefault(),e.execute("justifyCenter");break;case"R":t.preventDefault(),e.execute("justifyRight");break;case"L":t.preventDefault(),e.execute("justifyLeft");break;case"J":t.preventDefault(),e.execute("justifyFull");break;case"A":t.shiftKey&&(t.preventDefault(),C.selectElement(e.editor));break;case"F":t.preventDefault(),t.shiftKey&&e.toggleFullScreen();break;case"Z":if(t.preventDefault(),t.shiftKey){e.execute("redo");break}e.execute("undo");break;case"\\":t.preventDefault(),e.execute("removeFormat");break;case"=":if(t.preventDefault(),t.shiftKey){e.execute("superscript");break}e.execute("subscript")}switch(t.key){case"Tab":if(t.preventDefault(),t.shiftKey){e.execute("outdent",!1,!0);break}e.execute("indent",!1,!0);break;case"Escape":e.el.classList.remove("is-fullscreen"),c()}setTimeout(e.update.bind(e),1)}},!0)}},{key:"clearContent",value:function(){this.sections=[],this.editor.innerHTML=""}},{key:"highlight",value:function(){if("undefined"!=typeof hljs){Array.from(this.editor.querySelectorAll("pre")).forEach(function(e){hljs.highlightBlock(e)})}}},{key:"toggleFullScreen",value:function(){if(!document.fullscreenElement&&!document.webkitIsFullScreen)return r(this.el),void this.el.classList.add("is-fullscreen");this.el.classList.remove("is-fullscreen"),c()}},{key:"update",value:function(){var e=this;C.update(),setTimeout(function(){e.settings.toolbar&&e.toolbar.update(),e.settings.bubble&&e.bubble.update(),e.settings.creator&&e.creator.update()},16)}},{key:"applyFont",value:function(e,t){this.el.style.fontFamily=t.fontName[0]}},{key:"execute",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.editor.focus(),document.execCommand("styleWithCSS",!1,n),document.execCommand(e,!1,t),document.execCommand("styleWithCSS",!1,!1),this.update()}},{key:"createFigure",value:function(e,t){var n=t.target,i=n.files[0];if(i&&C.range){var o=new S(this,i);n.value=null,o.el&&C.range.insertNode(o.el)}}},{key:"createVideo",value:function(){var e=new R(this,{message:"Enter video link:"});e.onSubmit(function(){var t=e.inputs[0].value;if(t){var n=t.includes("yout")?"youtube":t.includes("vimeo")?"vimeo":"";if(n){var i=u(t,n),o=document.createElement("iframe");o.width=560,o.height=315,o.allowfullscreen=!0,o.contentEditable=!1,o.src="youtube"===n?"//www.youtube.com/embed/"+i:"vimeo"===n?"//player.vimeo.com/video/"+i:"",C.range.insertNode(o)}}})}},{key:"createColumn",value:function(){var e=new R(this,{message:"Enter columns count:",inputsCount:1});e.onSubmit(function(){var t=d('<div class="align-grid">\n        '+'<div class="align-column"><br></div>'.repeat(e.inputs[0].value)+"\n      </div>");C.range.insertNode(t)})}},{key:"createTable",value:function(){var e=this,t=new R(this,{message:"Enter post link:",inputsCount:2,inputsPlaceholders:["rows","columns"]});t.onSubmit(function(){var n=new x(e,{rows:t.inputs[0].value,columns:t.inputs[1].value}).el;C.range.insertNode(n)})}},{key:"createLine",value:function(e,t){C.range.insertNode(d(t))}},{key:"createPost",value:function(){var e=new R(this,{message:"Enter post link:"});e.onSubmit(function(){var t=e.inputs[0].value;if(t){var n=document.createElement("iframe");n.width=500,n.height=200,n.scrolling="no",n.contentEditable=!1,n.allowTransparency=!0,n.src="//www.facebook.com/plugins/post.php?href="+t,C.range.insertNode(n)}})}},{key:"createEmbed",value:function(){var e=new R(this,{message:"Add an embedded:"});e.onSubmit(function(){var t=e.inputs[0].value;if(t){var n=document.createElement("div");n.insertAdjacentHTML("afterbegin",t),C.range.insertNode(n)}})}},{key:"createLink",value:function(){new $(this).edit()}},{key:"content",get:function(){return this.sections.reduce(function(e,t){return"text"!==t.type?e:e+=t.content},"")}},{key:"title",get:function(){if(this.postTitle){return _.allSections.find(function(e){return"title"===e.type}).content}}}],[{key:"extend",value:function(e,t){w[e]=t}},{key:"extendIcons",value:function(e,t){m[e]=t}}]),e}()});